import{c as R,z as F,r as n,d as H,b as Q,u as O,h as k,j as e,L as U,S as Z,U as I,E as X,s as G,o as J}from"./index-b9nMIW9s.js";import{u as W}from"./index-DcdVQ9mx.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]],ee=R("lock-open",Y),te=a=>{switch(a){case"admin":return"Quáº£n trá»‹ viÃªn cáº¥p cao";case"user":return"NgÆ°á»i dÃ¹ng";case"partner":return"Äá»‘i tÃ¡c";case"reseller":return"Äáº¡i lÃ½";case"nv-ho-tro":return"NhÃ¢n viÃªn há»— trá»£";case"nv-kiem-duyet":return"NhÃ¢n viÃªn kiá»ƒm duyá»‡t";case"admin-super":return"Quáº£n trá»‹ viÃªn";case"nv-marketing":return"NhÃ¢n viÃªn marketing";case"ke-toan":return"NhÃ¢n viÃªn Káº¿ toÃ¡n";default:return a||"KhÃ´ng rÃµ"}},se=({roleName:a})=>{const i={admin:"bg-red-100 text-red-800 dark:bg-red-900/40 dark:text-red-300","admin-super":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/40 dark:text-yellow-300",reseller:"bg-purple-100 text-purple-800 dark:bg-purple-900/40 dark:text-purple-300",partner:"bg-sky-100 text-sky-800 dark:bg-sky-900/40 dark:text-sky-300",user:"bg-slate-100 text-slate-800 dark:bg-slate-700 dark:text-slate-300","ke-toan":"bg-teal-100 text-teal-800 dark:bg-teal-900/40 dark:text-teal-300","nv-ho-tro":"bg-cyan-100 text-cyan-800 dark:bg-cyan-900/40 dark:text-cyan-300","nv-marketing":"bg-pink-100 text-pink-800 dark:bg-pink-900/40 dark:text-pink-300","nv-kiem-duyet":"bg-orange-100 text-orange-800 dark:bg-orange-900/40 dark:text-orange-300"};return e.jsx("span",{className:`px-2.5 py-0.5 rounded-full text-xs font-semibold ${i[a]||i.user}`,children:te(a)})},ae=({status:a})=>e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-semibold ${a===1?"bg-green-100 text-green-800 dark:bg-green-900/40 dark:text-green-300":"bg-red-100 text-red-800 dark:bg-red-900/40 dark:text-red-300"}`,children:a===1?"Hoáº¡t Ä‘á»™ng":"Bá»‹ khÃ³a"}),le=()=>{const{can:a}=F(),i=a("users.view");console.log("ðŸš€ ~ AccountListPage ~ isView:",i);const A=a("users.create");console.log("ðŸš€ ~ AccountListPage ~ isCreate:",A);const c=a("users.edit");console.log("ðŸš€ ~ AccountListPage ~ isEdit:",c);const E=a("users.delete");console.log("ðŸš€ ~ AccountListPage ~ isDelete:",E);const[b,j]=n.useState([]),[f,P]=n.useState(null),[x,$]=n.useState([]),[y,d]=n.useState(!0),B=H(),[v,N]=n.useState(1),[w,z]=n.useState(""),[u,V]=n.useState({role_id:"",status:""}),[g,D]=n.useState({by:"created_at",direction:"desc"}),{user:m}=Q(),p=W(w,500),{pop:l,conFim:S}=O(),C=n.useCallback(async()=>{d(!0);try{const t={page:v,search:p,role_id:u.role_id,status:u.status,sort_by:g.by,sort_direction:g.direction};Object.keys(t).forEach(r=>(t[r]===""||t[r]===null)&&delete t[r]);const s=await k.get("/admin/accounts",{params:t});j(s.data.data.users.data),P(s.data.data.users),x.length===0&&$(s.data.data.roles)}catch(t){console.error("Lá»—i khi táº£i danh sÃ¡ch:",t),l("Lá»—i khi táº£i danh sÃ¡ch tÃ i khoáº£n","e")}finally{d(!1)}},[v,p,u,g,l,x.length]);n.useEffect(()=>{C()},[C]),n.useEffect(()=>{N(1)},[p,u]);const T=async(t,s)=>{var _,K;if(t==(m==null?void 0:m.id)){l("Báº¡n khÃ´ng thá»ƒ khÃ³a tÃ i khoáº£n cá»§a mÃ¬nh","e");return}try{if(s===1){if(!await S("Ban cÃ³ muá»‘n khÃ³a tÃ i khoáº£n nÃ y láº¡i"))return;d(!0);const h=await k.delete(`/admin/accounts/${t}`);if(d(!1),h.data.status)l("KhÃ³a tÃ i khoáº£n thÃ nh cÃ´ng","s");else{l("KhÃ³a tÃ i khoáº£n khÃ´ng thÃ nh cÃ´ng","e");return}}else{if(!await S("Ban cÃ³ muá»‘n khÃ´i phá»¥c tÃ i khoáº£n nÃ y láº¡i"))return;d(!0);const h=await k.patch(`/admin/accounts/${t}`);if(d(!1),h.data.status)l("KhÃ´i phá»¥c tÃ i khoáº£n thÃ nh cÃ´ng","s");else{l("KhÃ´i phá»¥c tÃ i khoáº£n khÃ´ng thÃ nh cÃ´ng","e");return}}j(o=>o.map(h=>h.id===t?{...h,status:s===1?0:1}:h))}catch(o){d(!1),l(`${((K=(_=o==null?void 0:o.response)==null?void 0:_.data)==null?void 0:K.message)??"Thao tÃ¡c tháº¥t báº¡i"}`,"e"),console.error(o)}},q=t=>B(`/admin/users/${t}`),L=t=>{V(s=>({...s,[t.target.name]:t.target.value}))},M=t=>{const[s,r]=t.target.value.split(",");D({by:s,direction:r})};return e.jsxs("div",{className:"p-4 sm:p-6 bg-slate-50 dark:bg-slate-900 min-h-screen font-sans",children:[e.jsxs("header",{className:"mb-6 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-800 dark:text-slate-100",children:"Quáº£n lÃ½ tÃ i khoáº£n"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:"TÃ¬m kiáº¿m, lá»c vÃ  quáº£n lÃ½ táº¥t cáº£ ngÆ°á»i dÃ¹ng trong há»‡ thá»‘ng."})]}),e.jsx("div",{children:e.jsx(U,{to:"/admin/users/new",children:"ThÃªm tÃ i khoáº£n nhÃ¢n viÃªn"})})]}),e.jsx("div",{className:"p-4 bg-white dark:bg-slate-800 rounded-lg shadow-sm mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative sm:col-span-2 md:col-span-1",children:[e.jsx(Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18}),e.jsx("input",{type:"text",placeholder:"TÃ¬m theo email, username...",value:w,onChange:t=>z(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-700 text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),e.jsxs("select",{name:"role_id",value:u.role_id,onChange:L,className:"w-full px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-700 text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[e.jsx("option",{value:"",children:"Táº¥t cáº£ vai trÃ²"}),x.map(t=>e.jsx("option",{value:t.id,children:t.description||t.name},t.id))]}),e.jsxs("select",{name:"status",value:u.status,onChange:L,className:"w-full px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-700 text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[e.jsx("option",{value:"",children:"Táº¥t cáº£ tráº¡ng thÃ¡i"}),e.jsx("option",{value:"1",children:"Hoáº¡t Ä‘á»™ng"}),e.jsx("option",{value:"2",children:"Bá»‹ khÃ³a"}),e.jsx("option",{value:"0",children:"ChÆ°a kÃ­ch hoáº¡t"})]}),e.jsxs("select",{onChange:M,defaultValue:"created_at,desc",className:"w-full px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-700 text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[e.jsx("option",{value:"created_at,desc",children:"Má»›i nháº¥t"}),e.jsx("option",{value:"username,asc",children:"TÃªn A-Z"}),e.jsx("option",{value:"username,desc",children:"TÃªn Z-A"}),e.jsx("option",{value:"balance,desc",children:"Sá»‘ dÆ°: Cao Ä‘áº¿n tháº¥p"}),e.jsx("option",{value:"balance,asc",children:"Sá»‘ dÆ°: Tháº¥p Ä‘áº¿n cao"})]})]})}),e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left text-slate-500 dark:text-slate-400",children:[e.jsx("thead",{className:"text-xs text-slate-700 dark:text-slate-300 uppercase bg-slate-50 dark:bg-slate-700/50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3",children:"TÃ i khoáº£n"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Vai trÃ²"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Sá»‘ dÆ°"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Tráº¡ng thÃ¡i"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-center",children:"HÃ nh Ä‘á»™ng"})]})}),e.jsx("tbody",{children:y?Array.from({length:5}).map((t,s)=>e.jsx("tr",{className:"animate-pulse",children:e.jsx("td",{className:"px-6 py-4",colSpan:"5",children:e.jsx("div",{className:"h-4 bg-slate-200 dark:bg-slate-700 rounded w-full"})})},s)):b.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:"5",className:"text-center py-16 text-slate-500",children:[e.jsx(I,{size:48,className:"mx-auto mb-2"}),"KhÃ´ng tÃ¬m tháº¥y tÃ i khoáº£n nÃ o."]})}):b.map(t=>{var s;return e.jsxs("tr",{className:"bg-white dark:bg-slate-800 border-b dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors",children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"font-semibold text-slate-800 dark:text-slate-100",children:t.username}),e.jsx("div",{className:"text-xs text-slate-500",children:t.email})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"flex flex-wrap gap-1",children:t.roles.map(r=>e.jsx(se,{roleName:r.name},r.id))})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:"font-mono text-slate-700 dark:text-slate-200",children:[Number(((s=t.wallet)==null?void 0:s.balance)||0).toLocaleString()," VND"]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(ae,{status:t.status})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("button",{title:i?"Xem Chi tiáº¿t":"KhÃ´ng cÃ³ quyá»n",className:` p-2 rounded-full transition-colors ${i?"text-slate-500 hover:bg-slate-200 dark:hover:bg-slate-700 hover:text-indigo-600":"text-slate-400 opacity-50 cursor-not-allowed"}`,onClick:()=>q(t.id),disabled:!i,children:e.jsx(X,{size:16})}),t.status===1?e.jsx("button",{title:c?"KhÃ³a tÃ i khoáº£n":"KhÃ´ng cÃ³ quyá»n",onClick:()=>T(t.id,t.status),className:` p-2 rounded-full transition-colors ${c?"text-slate-500 hover:bg-slate-200 dark:hover:bg-slate-700 hover:text-indigo-600":"text-slate-400 opacity-50 cursor-not-allowed"}`,disabled:!c,children:e.jsx(G,{size:16})}):e.jsx("button",{title:c?" Má»Ÿ KhÃ³a tÃ i khoáº£n":"KhÃ´ng cÃ³ quyá»n",onClick:()=>T(t.id,t.status),className:` p-2 rounded-full transition-colors ${c?"text-slate-500 hover:bg-slate-200 dark:hover:bg-slate-700 hover:text-indigo-600":"text-slate-400 opacity-50 cursor-not-allowed"}`,disabled:!c,children:e.jsx(ee,{size:16})})]})})]},t.id)})})]})}),!y&&f&&e.jsx(J,{meta:f,onPageChange:t=>N(t)})]})};export{le as default};
