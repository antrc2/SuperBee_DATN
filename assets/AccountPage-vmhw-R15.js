import{c as P,r as a,b as z,a as $,u as M,f as m,j as e,S as V,U as F,g as H,n as R}from"./index-OefKdV4-.js";import{P as D}from"./Pagination-B0ANGdal.js";import{u as O}from"./index-CW-6dsA4.js";import"./chevron-left-DzZmHbAx.js";import"./chevron-right-C6ZOff9V.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]],Z=P("lock-open",U),q=({roleName:r})=>{const i={admin:"bg-red-100 text-red-800 dark:bg-red-900/40 dark:text-red-300","admin-super":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/40 dark:text-yellow-300",reseller:"bg-purple-100 text-purple-800 dark:bg-purple-900/40 dark:text-purple-300",partner:"bg-sky-100 text-sky-800 dark:bg-sky-900/40 dark:text-sky-300",user:"bg-slate-100 text-slate-800 dark:bg-slate-700 dark:text-slate-300","ke-toan":"bg-teal-100 text-teal-800 dark:bg-teal-900/40 dark:text-teal-300","nv-ho-tro":"bg-cyan-100 text-cyan-800 dark:bg-cyan-900/40 dark:text-cyan-300","nv-marketing":"bg-pink-100 text-pink-800 dark:bg-pink-900/40 dark:text-pink-300","nv-kiem-duyet":"bg-orange-100 text-orange-800 dark:bg-orange-900/40 dark:text-orange-300"};return e.jsx("span",{className:`px-2.5 py-0.5 rounded-full text-xs font-semibold ${i[r]||i.user}`,children:(r==null?void 0:r.replace(/-/g," "))||"Không rõ"})},I=({status:r})=>e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-semibold ${r===1?"bg-green-100 text-green-800 dark:bg-green-900/40 dark:text-green-300":"bg-red-100 text-red-800 dark:bg-red-900/40 dark:text-red-300"}`,children:r===1?"Hoạt động":"Bị khóa"}),Y=()=>{const[r,i]=a.useState([]),[b,C]=a.useState(null),[x,T]=a.useState([]),[k,d]=a.useState(!0),_=z(),[j,f]=a.useState(1),[y,L]=a.useState(""),[c,A]=a.useState({role_id:"",status:""}),[u,B]=a.useState({by:"created_at",direction:"desc"}),{user:g}=$(),p=O(y,500),{pop:l,conFim:v}=M(),N=a.useCallback(async()=>{d(!0);try{const t={page:j,search:p,role_id:c.role_id,status:c.status,sort_by:u.by,sort_direction:u.direction};Object.keys(t).forEach(n=>(t[n]===""||t[n]===null)&&delete t[n]);const s=await m.get("/admin/accounts",{params:t});i(s.data.data.users.data),C(s.data.data.users),x.length===0&&T(s.data.data.roles)}catch(t){console.error("Lỗi khi tải danh sách:",t),l("Lỗi khi tải danh sách tài khoản","e")}finally{d(!1)}},[j,p,c,u,l,x.length]);a.useEffect(()=>{N()},[N]),a.useEffect(()=>{f(1)},[p,c]);const w=async(t,s)=>{if(t==(g==null?void 0:g.id)){l("Bạn không thể khóa tài khoản của mình","e");return}try{if(s===1){if(!await v("Ban có muốn khóa tài khoản này lại"))return;d(!0);const o=await m.delete(`/admin/accounts/${t}`);if(d(!1),o.data.status)l("Khóa tài khoản thành công","s");else{l("Khóa tài khoản không thành công","e");return}}else{if(!await v("Ban có muốn khôi phục tài khoản này lại"))return;d(!0);const o=await m.patch(`/admin/accounts/${t}`);if(d(!1),o.data.status)l("Khôi phục tài khoản thành công","s");else{l("Khôi phục tài khoản không thành công","e");return}}i(h=>h.map(o=>o.id===t?{...o,status:s===1?0:1}:o))}catch(h){l("Thao tác thất bại","e"),console.error(h)}},K=t=>_(`/admin/users/${t}`),S=t=>{A(s=>({...s,[t.target.name]:t.target.value}))},E=t=>{const[s,n]=t.target.value.split(",");B({by:s,direction:n})};return e.jsxs("div",{className:"p-4 sm:p-6 bg-slate-50 dark:bg-slate-900 min-h-screen font-sans",children:[e.jsxs("header",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-800 dark:text-slate-100",children:"Quản lý tài khoản"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:"Tìm kiếm, lọc và quản lý tất cả người dùng trong hệ thống."})]}),e.jsx("div",{className:"p-4 bg-white dark:bg-slate-800 rounded-lg shadow-sm mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative sm:col-span-2 md:col-span-1",children:[e.jsx(V,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18}),e.jsx("input",{type:"text",placeholder:"Tìm theo email, username...",value:y,onChange:t=>L(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-700 text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),e.jsxs("select",{name:"role_id",value:c.role_id,onChange:S,className:"w-full px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-700 text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[e.jsx("option",{value:"",children:"Tất cả vai trò"}),x.map(t=>e.jsx("option",{value:t.id,children:t.description||t.name},t.id))]}),e.jsxs("select",{name:"status",value:c.status,onChange:S,className:"w-full px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-700 text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[e.jsx("option",{value:"",children:"Tất cả trạng thái"}),e.jsx("option",{value:"1",children:"Hoạt động"}),e.jsx("option",{value:"2",children:"Bị khóa"}),e.jsx("option",{value:"0",children:"Chưa kích hoạt"})]}),e.jsxs("select",{onChange:E,defaultValue:"created_at,desc",className:"w-full px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-700 text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[e.jsx("option",{value:"created_at,desc",children:"Mới nhất"}),e.jsx("option",{value:"username,asc",children:"Tên A-Z"}),e.jsx("option",{value:"username,desc",children:"Tên Z-A"}),e.jsx("option",{value:"balance,desc",children:"Số dư: Cao đến thấp"}),e.jsx("option",{value:"balance,asc",children:"Số dư: Thấp đến cao"})]})]})}),e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left text-slate-500 dark:text-slate-400",children:[e.jsx("thead",{className:"text-xs text-slate-700 dark:text-slate-300 uppercase bg-slate-50 dark:bg-slate-700/50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Tài khoản"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Vai trò"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Số dư"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Trạng thái"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-center",children:"Hành động"})]})}),e.jsx("tbody",{children:k?Array.from({length:5}).map((t,s)=>e.jsx("tr",{className:"animate-pulse",children:e.jsx("td",{className:"px-6 py-4",colSpan:"5",children:e.jsx("div",{className:"h-4 bg-slate-200 dark:bg-slate-700 rounded w-full"})})},s)):r.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:"5",className:"text-center py-16 text-slate-500",children:[e.jsx(F,{size:48,className:"mx-auto mb-2"}),"Không tìm thấy tài khoản nào."]})}):r.map(t=>{var s;return e.jsxs("tr",{className:"bg-white dark:bg-slate-800 border-b dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors",children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"font-semibold text-slate-800 dark:text-slate-100",children:t.username}),e.jsx("div",{className:"text-xs text-slate-500",children:t.email})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"flex flex-wrap gap-1",children:t.roles.map(n=>e.jsx(q,{roleName:n.name},n.id))})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:"font-mono text-slate-700 dark:text-slate-200",children:[Number(((s=t.wallet)==null?void 0:s.balance)||0).toLocaleString()," VND"]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(I,{status:t.status})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("button",{title:"Chỉnh sửa",className:"p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-500 hover:text-indigo-600 transition-colors",onClick:()=>K(t.id),children:e.jsx(H,{size:16})}),t.status===1?e.jsx("button",{title:"Khóa",onClick:()=>w(t.id,t.status),className:"p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-500 hover:text-red-600 transition-colors",children:e.jsx(R,{size:16})}):e.jsx("button",{title:"Mở khóa",onClick:()=>w(t.id,t.status),className:"p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-500 hover:text-green-600 transition-colors",children:e.jsx(Z,{size:16})})]})})]},t.id)})})]})}),!k&&b&&e.jsx(D,{meta:b,onPageChange:t=>f(t)})]})};export{Y as default};
