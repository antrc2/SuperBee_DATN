import{c as I,r as d,u as T,b as _,d as M,j as e,a5 as j,a6 as z,e as $,a4 as b,h as B}from"./index-DNv7UJt1.js";import{u as D}from"./index.esm-CuFITDL9.js";import{c as f,a as v}from"./recharge-7Wy_Gsf5.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],q=I("download",R);function A(){const{register:i,handleSubmit:a,formState:{errors:n},reset:l}=D({defaultValues:{serial:"",pin:""}}),[o,h]=d.useState(f[0].id),[m,u]=d.useState(v[4].value),[s,x]=d.useState(null),{pop:p}=T(),{fetchUserMoney:k,isLoggedIn:g}=_(),C=M();d.useEffect(()=>{if(g){const t=sessionStorage.getItem("nap_cart");if(t)try{const r=JSON.parse(t);h(r.telco),u(r.amount),l({serial:r.serial,pin:r.code}),p("Th√¥ng tin n·∫°p th·∫ª c·ªßa b·∫°n ƒë√£ ƒë∆∞·ª£c kh√¥i ph·ª•c.","success"),sessionStorage.removeItem("nap_cart")}catch(r){console.error("L·ªói khi ƒë·ªçc d·ªØ li·ªáu n·∫°p th·∫ª ƒë√£ l∆∞u:",r),sessionStorage.removeItem("nap_cart")}}},[g,l,p]);const S=async t=>{var N,y;if(!g){const c={telco:o,amount:m,serial:t.serial,code:t.pin};localStorage.setItem("location","/recharge-atm"),sessionStorage.setItem("nap_cart",JSON.stringify(c)),p("Vui l√≤ng ƒëƒÉng nh·∫≠p ƒë·ªÉ ho√†n t·∫•t n·∫°p th·∫ª.","info"),C("/auth/login");return}x({type:"loading",message:"ƒêang ki·ªÉm tra th·∫ª, vui l√≤ng ch·ªù..."});const r={telco:o,amount:m,serial:t.serial,code:t.pin};try{const c=await B.post("/donate/card",r);c.data.success?(x({type:"success",message:c.data.message||"G·ª≠i th·∫ª th√†nh c√¥ng! Vui l√≤ng ch·ªù duy·ªát."}),l(),k()):x({type:"error",message:c.data.message||"N·∫°p th·∫ª th·∫•t b·∫°i. Vui l√≤ng th·ª≠ l·∫°i."})}catch(c){const w=((y=(N=c.response)==null?void 0:N.data)==null?void 0:y.message)||"ƒê√£ c√≥ l·ªói x·∫£y ra t·ª´ m√°y ch·ªß.";x({type:"error",message:w})}};return e.jsxs("form",{onSubmit:a(S),className:"space-y-4 animate-fade-in",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary mb-2",children:"1. Ch·ªçn lo·∫°i th·∫ª"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:f.map(t=>e.jsx("div",{onClick:()=>h(t.id),className:`selection-grid-item ${o===t.id?"selection-grid-item-selected":""}`,children:e.jsx("img",{src:t.logo,alt:t.name,className:"h-8 mx-auto object-contain"})},t.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary mb-2",children:"2. Ch·ªçn m·ªánh gi√°"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:v.map(t=>e.jsx("div",{onClick:()=>u(t.value),className:`selection-grid-item text-xs font-semibold ${m===t.value?"selection-grid-item-selected":""}`,children:t.label},t.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary mb-1",children:"3. Nh·∫≠p th√¥ng tin th·∫ª"}),e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsx("input",{type:"text",placeholder:"S·ªë Seri",className:`block w-full px-4 py-2 text-sm rounded-lg border-hover bg-input text-input ${n.serial?"border-red-500":""}`,...i("serial",{required:"S·ªë seri l√† b·∫Øt bu·ªôc.",pattern:{value:/^[a-zA-Z0-9]{8,20}$/,message:"Serial kh√¥ng h·ª£p l·ªá."}})}),n.serial&&e.jsxs("p",{className:"text-xs text-red-500 flex items-center gap-1",children:[e.jsx(j,{size:14}),n.serial.message]}),e.jsx("input",{type:"text",placeholder:"M√£ PIN",className:`block w-full px-4 py-2 text-sm rounded-lg border-hover bg-input text-input ${n.pin?"border-red-500":""}`,...i("pin",{required:"M√£ PIN l√† b·∫Øt bu·ªôc.",pattern:{value:/^[a-zA-Z0-9]{8,20}$/,message:"M√£ PIN kh√¥ng h·ª£p l·ªá."}})}),n.pin&&e.jsxs("p",{className:"text-xs text-red-500 flex items-center gap-1",children:[e.jsx(j,{size:14}),n.pin.message]})]})]}),s&&e.jsx("div",{className:`alert ${s.type==="success"?"alert-success":s.type==="error"?"alert-danger":"alert-info"}`,children:s.message}),e.jsxs("div",{className:"alert alert-warning",children:[e.jsx("strong",{children:"L∆∞u √Ω:"})," Vui l√≤ng ch·ªçn ƒë√∫ng m·ªánh gi√°. Sai m·ªánh gi√° s·∫Ω kh√¥ng ƒë∆∞·ª£c c·ªông ti·ªÅn."]}),e.jsxs("button",{type:"submit",disabled:(s==null?void 0:s.type)==="loading",className:"w-full py-3 font-heading flex items-center justify-center gap-2 text-sm font-bold rounded-lg transition-all text-accent-contrast bg-gradient-button hover:brightness-110 disabled:opacity-60",children:[(s==null?void 0:s.type)==="loading"?e.jsx(z,{size:16,className:"animate-spin"}):e.jsx($,{size:16}),(s==null?void 0:s.type)==="loading"?"ƒêang X·ª≠ L√Ω...":"N·∫°p Th·∫ª Ngay"]})]})}const U=({user:i})=>{console.log("üöÄ ~ BankRechargeTab ~ user:",i);const a=d.useRef(null),[n,l]=d.useState(""),o=(h,m)=>{navigator.clipboard.writeText(h).then(()=>{l(m),setTimeout(()=>l(""),2e3)})};if(i)a.current={bankName:"Ng√¢n h√†ng Qu√¢n ƒë·ªôi (MB Bank)",accountNumber:"0838411897",accountHolder:"NGUYEN NGOC AN",transferContentPrefix:`${i.donate_code}`,qrCodeUrl:`https://img.vietqr.io/image/MB-0838411897-qr_only.png?addInfo=${i.donate_code}`};else return e.jsx(LoadingDomain,{});return e.jsx("div",{className:"bg-content p-6 sm:p-8 rounded-lg shadow-lg animate-fade-in",children:e.jsxs("div",{className:"flex flex-col  items-center gap-8",children:[e.jsxs("div",{className:"flex-shrink-0 text-center",children:[e.jsx("img",{src:a.current.qrCodeUrl,alt:"Bank QR Code",className:"w-48 h-48 sm:w-56 sm:h-56 object-contain border rounded-lg p-2 bg-white shadow-sm"}),e.jsxs("a",{href:a.current.qrCodeUrl,download:"Ma_QR_SuperBee.png",className:"mt-3 inline-flex items-center text-secondary hover:text-primary text-sm font-medium",children:[e.jsx(q,{size:16,className:"mr-1"})," T·∫£i m√£ QR"]})]}),e.jsxs("div",{className:"w-full text-sm space-y-3",children:[e.jsxs("p",{className:"text-secondary",children:["Ng√¢n h√†ng:"," ",e.jsx("strong",{className:"text-primary",children:a.current.bankName})]}),e.jsxs("p",{className:"text-secondary",children:["Ch·ªß t√†i kho·∫£n:"," ",e.jsx("strong",{className:"text-primary",children:a.current.accountHolder})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-secondary",children:["S·ªë t√†i kho·∫£n:"," ",e.jsx("strong",{className:"text-primary",children:a.current.accountNumber})]}),e.jsx("button",{onClick:()=>o(a.current.accountNumber,"account"),className:"text-secondary hover:text-primary",children:e.jsx(b,{size:16})}),n==="account"&&e.jsx("span",{className:"text-xs text-tertiary",children:"ƒê√£ ch√©p!"})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-input border-themed border",children:[e.jsx("p",{className:"text-secondary",children:"N·ªôi dung chuy·ªÉn kho·∫£n:"}),e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e.jsx("strong",{className:"text-lg text-highlight",children:a.current.transferContentPrefix}),e.jsx("button",{onClick:()=>o(a.current.transferContentPrefix,"content"),className:"text-secondary hover:text-primary",children:e.jsx(b,{size:16})}),n==="content"&&e.jsx("span",{className:"text-xs text-tertiary",children:"ƒê√£ ch√©p!"})]})]})]})]})})};export{U as B,A as C};
