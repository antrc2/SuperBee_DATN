import{r as u,u as $,a2 as O,j as e,g as R,a3 as y,L as v,C as w,aw as V,e as B,aC as D}from"./index-DJ8jfsRI.js";import{T as C}from"./trash-2-D4u99yQ1.js";import{F as X}from"./file-text-C3xydfHq.js";const f=a=>{const l=Number(a);return isNaN(l)?"0 ₫":new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(l)},k=a=>{if(!a||!a.price)return 0;const l=Number(a.price),d=Number(a.sale);return d>0&&d<l?d:l};function _(){const[a,l]=u.useState({}),{pop:d,conFim:p}=$(),{removeItem:j,fetchCartItems:g,cartItems:n,loadingCart:S,handleUpdateSave:P}=O();u.useEffect(()=>{g()},[g]),u.useEffect(()=>{if(n&&n.length>0){const t={};n.forEach(s=>{s.product&&s.product.status===1&&(t[s.id]=!0)}),l(t)}},[n]);const I=(t,s)=>{s===1&&l(r=>({...r,[t]:!r[t]}))},T=t=>{const s=t.target.checked,r={};s&&n.forEach(i=>{i.product&&i.product.status===1&&(r[i.id]=!0)}),l(r)},z=async(t,s)=>{await p(`Bạn có chắc chắn muốn xóa "${s}" khỏi giỏ hàng?`)&&await j(t)},F=async()=>{const t=Object.keys(a).filter(s=>a[s]);if(t.length===0){d("Vui lòng chọn ít nhất một sản phẩm để xóa.","warning");return}if(await p(`Bạn có chắc muốn xóa ${t.length} sản phẩm đã chọn?`)){for(const s of t)await j(s);d("Đã xóa các sản phẩm đã chọn.","success")}},{totalSelectedCount:b,subtotalPrice:E,totalPrice:A,isAllSelected:G}=u.useMemo(()=>{const t=n.filter(c=>a[c.id]&&c.product&&c.product.status===1),s=t.length,r=t.reduce((c,h)=>c+k(h.product),0),o=r+0,m=n.filter(c=>c.product&&c.product.status===1).length,x=m>0&&s===m;return{totalSelectedCount:s,subtotalPrice:r,totalPrice:o,isAllSelected:x}},[n,a]),L=async()=>{P(a)};if(S)return e.jsx(R,{});if(!n||n.length===0)return e.jsx("div",{className:"min-h-screen p-4 sm:p-6 lg:p-8 flex items-center justify-center",children:e.jsxs("div",{className:"max-w-md mx-auto text-center section-bg p-12",children:[e.jsx(y,{size:80,className:"mx-auto text-accent mb-6"}),e.jsx("h1",{className:"text-3xl font-bold font-heading text-primary",children:"Giỏ hàng của bạn đang trống"}),e.jsx("p",{className:"my-4 text-secondary",children:"Có vẻ như bạn chưa thêm sản phẩm nào. Hãy khám phá ngay!"}),e.jsxs(v,{to:"/",className:"action-button action-button-primary max-w-xs mx-auto",children:[e.jsx(w,{size:20,className:"mr-2"}),"Tiếp tục mua sắm"]})]})});const M=Object.keys(a).filter(t=>a[t]);return e.jsx("div",{className:"min-h-screen ",children:e.jsxs("div",{className:"max-w-screen-xl mx-auto",children:[e.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row justify-between items-center gap-4 px-4 py-3",children:[e.jsxs("h1",{className:"text-3xl font-bold font-heading text-primary flex items-center gap-3",children:[e.jsx(y,{size:32,className:"text-accent"}),"Giỏ hàng (",n.length,")"]}),e.jsxs(v,{to:"/",className:"inline-flex items-center font-bold text-accent transition-all hover:brightness-110",children:[e.jsx(w,{size:20,className:"mr-1"}),"Tiếp tục mua sắm"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 section-bg p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 pb-4 border-b border-themed",children:[e.jsxs("label",{className:"flex items-center cursor-pointer group",children:[e.jsx("input",{type:"checkbox",checked:G,onChange:T,className:"h-4 w-4 rounded"}),e.jsxs("span",{className:"ml-3 text-secondary font-semibold",children:["Chọn tất cả (",n.filter(t=>t.product&&t.product.status===1).length," ","sản phẩm)"]})]}),e.jsxs("button",{onClick:F,disabled:M.length===0,className:"flex items-center text-sm text-red-500 hover:text-red-400 disabled:text-secondary/50 disabled:cursor-not-allowed transition-colors",children:[e.jsx(C,{size:16,className:"mr-2"})," Xóa mục đã chọn"]})]}),e.jsx("div",{className:"space-y-4",children:n.map(t=>{var m,x,c,h;const s=t.product;if(!s)return null;const r=k(s),i=s.status!==1;let o="";return s.status===2?o="Đang chờ duyệt":s.status===3?o="Tạm hết hàng":s.status===4?o="Đã bán":s.status!==1&&(o="Không có sẵn"),e.jsxs("div",{className:`grid grid-cols-12 gap-4 items-center p-4 rounded-xl border transition-all duration-200 ${i?"bg-input/50 opacity-60 cursor-not-allowed border-themed":"bg-input border-themed hover:border-hover"}`,children:[e.jsx("div",{className:"col-span-1 flex items-center justify-center",children:e.jsx("input",{type:"checkbox",checked:!!a[t.id]&&!i,onChange:()=>I(t.id,s.status),disabled:i,className:"h-4 w-4 rounded"})}),e.jsxs("div",{className:"col-span-6 sm:col-span-5 flex items-center gap-4",children:[e.jsx(V,{url:((m=s==null?void 0:s.images[0])==null?void 0:m.image_url)||"/placeholder.svg",alt:(x=s==null?void 0:s.category)==null?void 0:x.name,className:"w-16 h-16 object-cover rounded-lg border-2 border-themed"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-primary text-base mb-1",children:(c=s==null?void 0:s.category)==null?void 0:c.name}),e.jsxs("p",{className:"text-sm text-secondary",children:["Mã: ",e.jsx("span",{className:"font-mono",children:s==null?void 0:s.sku})]}),i&&e.jsx("p",{className:"text-sm text-red-500 mt-1 font-semibold",children:o})]})]}),e.jsx("div",{className:"col-span-5 sm:col-span-3 text-right",children:e.jsx("p",{className:"text-lg font-bold text-red-500",children:f(r)})}),e.jsx("div",{className:"col-span-12 sm:col-span-3 flex items-center justify-end sm:justify-center",children:e.jsx("button",{onClick:()=>{var N;return z(t.id,(N=s==null?void 0:s.category)==null?void 0:N.name)},className:"p-2 text-secondary hover:text-red-500 hover:bg-red-500/10 rounded-lg transition-all","aria-label":`Xóa ${(h=s==null?void 0:s.category)==null?void 0:h.name}`,children:e.jsx(C,{size:20})})})]},t.id)})})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"section-bg p-6 sticky top-24",children:[e.jsxs("h2",{className:"text-2xl font-bold font-heading mb-6 text-primary flex items-center gap-3",children:[e.jsx(X,{size:24,className:"text-accent"}),"Tóm tắt đơn hàng"]}),e.jsxs("div",{className:"space-y-4 mb-6 text-sm",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-secondary",children:"Sản phẩm đã chọn"}),e.jsx("div",{className:"flex-grow border-b border-dashed border-themed mx-2"}),e.jsx("span",{className:"text-primary font-semibold",children:b})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-secondary",children:"Tạm tính"}),e.jsx("div",{className:"flex-grow border-b border-dashed border-themed mx-2"}),e.jsx("span",{className:"text-primary font-semibold",children:f(E)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-secondary",children:"Phí giao dịch"}),e.jsx("div",{className:"flex-grow border-b border-dashed border-themed mx-2"}),e.jsx("span",{className:"text-tertiary font-semibold",children:"Miễn phí"})]})]}),e.jsx("div",{className:"border-t border-themed pt-6 mb-6",children:e.jsxs("div",{className:"flex justify-between items-baseline",children:[e.jsx("span",{className:"text-lg font-semibold text-primary",children:"Tổng cộng:"}),e.jsx("span",{className:"text-3xl font-bold text-red-500",children:f(A)})]})}),e.jsxs("button",{onClick:L,disabled:b===0,className:"action-button action-button-primary w-full h-14 text-base",children:[e.jsx(B,{className:"mr-3",size:20}),"Thanh toán (",b,")"]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"flex items-center justify-center text-sm text-secondary",children:[e.jsx(D,{size:16,className:"mr-2 text-tertiary"}),"Giao dịch an toàn và bảo mật"]})})]})})]})]})})}export{_ as default};
