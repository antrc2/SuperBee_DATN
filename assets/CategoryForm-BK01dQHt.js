import{r as o,j as e,h as w}from"./index-DNv7UJt1.js";const _=["image/png","image/jpeg","image/webp","image/gif"],C="image/png, image/jpeg, image/webp, image/gif";function S({initialData:s,onSubmit:y,isEditing:u=!1,isLoading:x=!1}){const[d,f]=o.useState({name:"",parent_id:"",status:"1"}),[l,b]=o.useState(null),[k,p]=o.useState([]),[n,g]=o.useState({});o.useEffect(()=>{(async()=>{var a;try{let t=(a=(await w.get("/categories")).data)==null?void 0:a.data;t&&!Array.isArray(t)&&Array.isArray(t.treeCategories)&&(t=t.treeCategories),p(Array.isArray(t)?t:[])}catch(m){console.error("Error fetching categories:",m),p([])}})()},[]),o.useEffect(()=>{var r,a;s&&(f({name:s.name||"",parent_id:((r=s.parent_id)==null?void 0:r.toString())||"",status:((a=s.status)==null?void 0:a.toString())||"1"}),b(null),g({}))},[s]);const j=()=>{const r={...n};return(!d.name||!d.name.trim())&&(r.name="Tên danh mục không được để trống."),!u&&!l&&(r.image_url="Vui lòng chọn hình ảnh cho danh mục."),g(r),Object.keys(r).length===0},i=r=>{const{name:a,value:m,files:t}=r.target,h={...n};if(h[a]&&(delete h[a],g(h)),a==="image_url"&&t&&t[0]){const c=t[0];if(!_.includes(c.type)){g(N=>({...N,[a]:"Định dạng không hợp lệ. Chỉ chấp nhận .png, .jpg, .webp, .gif"})),b(null),r.target.value="";return}b(c)}else f(c=>({...c,[a]:m}))},v=r=>{if(r.preventDefault(),!j())return;const a=new FormData;a.append("name",d.name),a.append("parent_id",d.parent_id),a.append("status",d.status),l&&a.append("image_url",l),y(a)};return e.jsxs("form",{onSubmit:v,className:"space-y-6",noValidate:!0,children:[e.jsxs("div",{className:"p-6 border bg-white rounded-lg shadow-sm dark:bg-gray-800 dark:border-gray-700",children:[e.jsx("h3",{className:"mb-4 text-lg font-medium text-gray-900 dark:text-gray-100",children:"Thông tin cơ bản"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Tên danh mục"}),e.jsx("input",{name:"name",id:"name",value:d.name,onChange:i,className:`w-full p-2.5 rounded-md border bg-gray-50 text-gray-900 focus:ring-2 focus:ring-opacity-50 dark:bg-gray-700 dark:placeholder-gray-400 dark:text-white ${n.name?"border-red-500 focus:border-red-500 focus:ring-red-500 dark:border-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:focus:border-blue-500"}`,placeholder:"Nhập tên danh mục"}),n.name&&e.jsx("p",{className:"mt-2 text-sm text-red-600 dark:text-red-500",children:n.name})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"parent_id",className:"block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Danh mục cha"}),e.jsxs("select",{name:"parent_id",id:"parent_id",value:d.parent_id,onChange:i,className:"w-full p-2.5 rounded-md border border-gray-300 bg-gray-50 text-gray-900 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",children:[e.jsx("option",{value:"",children:"-- Không có --"}),k.filter(r=>!(u&&s&&r.id===s.id)).map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Trạng thái"}),e.jsxs("select",{name:"status",id:"status",value:d.status,onChange:i,className:"w-full p-2.5 rounded-md border border-gray-300 bg-gray-50 text-gray-900 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",children:[e.jsx("option",{value:"1",children:"Hoạt động"}),e.jsx("option",{value:"0",children:"Không hoạt động"})]})]})]})]}),e.jsxs("div",{className:"p-6 border bg-white rounded-lg shadow-sm dark:bg-gray-800 dark:border-gray-700",children:[e.jsx("h3",{className:"mb-4 text-lg font-medium text-gray-900 dark:text-gray-100",children:"Hình ảnh danh mục"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"image_url",className:"block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Chọn hoặc kéo thả ảnh"}),e.jsx("input",{type:"file",name:"image_url",id:"image_url",onChange:i,accept:C,className:`block w-full text-sm text-gray-900 border rounded-lg cursor-pointer bg-gray-50 dark:text-gray-400 focus:outline-none file:mr-4 file:py-2 file:px-4 file:rounded-l-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 dark:file:bg-blue-900 dark:file:text-blue-300 dark:hover:file:bg-blue-800 ${n.image_url?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"}`}),n.image_url&&e.jsx("p",{className:"mt-2 text-sm text-red-600 dark:text-red-500",children:n.image_url})]}),e.jsxs("div",{className:"mt-4",children:[s&&s.image_url&&!l&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2 dark:text-gray-400",children:"Ảnh hiện tại:"}),e.jsx("img",{src:s.image_url,loading:"lazy",alt:"Current category",className:"max-w-[200px] h-auto rounded-lg shadow-md border dark:border-gray-600"})]}),l&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2 dark:text-gray-400",children:"Ảnh xem trước:"}),e.jsx("img",{src:URL.createObjectURL(l),alt:"New category preview",className:"max-w-[200px] h-auto rounded-lg shadow-md border dark:border-gray-600"})]})]})]}),e.jsx("div",{className:"pt-4 flex justify-end",children:e.jsx("button",{type:"submit",disabled:x,className:"px-6 py-2.5 text-white bg-blue-600 hover:bg-blue-700 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm disabled:bg-gray-400 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800 dark:disabled:bg-gray-600",children:x?"Đang xử lý...":u?"Cập nhật":"Tạo mới"})})]})}export{S as C};
