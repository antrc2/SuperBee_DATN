import{c as T,j as e,a as E,L as k,i as H,r as c,u as z,S as $,h as v}from"./index-Ck68-v7X.js";import{H as M}from"./main-IXsw97lr.js";import{T as _}from"./trash-2-W9c-yGhX.js";import{P}from"./plus-DPCkgBJP.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],R=T("folder",A),X=({status:s})=>e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-semibold ${s===1?"bg-green-100 text-green-800 dark:bg-green-900/40 dark:text-green-300":"bg-slate-100 text-slate-800 dark:bg-slate-700 dark:text-slate-300"}`,children:s===1?"Hoạt động":"Ẩn"});function w({category:s,level:m=0,searchTerm:g,expandedIds:o,onToggle:a,onDelete:h}){const d={paddingLeft:`${m*24+16}px`},i=s.children&&s.children.length>0,u=o.includes(s.id);return e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:"bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors group",children:[e.jsx("td",{className:"px-4 py-3",style:d,children:e.jsxs("div",{className:"flex items-center gap-3",onClick:i?()=>a(s.id):void 0,children:[i?e.jsx(E,{size:16,className:`text-slate-400 group-hover:text-slate-600 transition-transform duration-200 ${u?"rotate-90":""}`}):e.jsx("span",{className:"w-4"}),s.image_url?e.jsx("img",{src:s.image_url,alt:s.name,className:"h-10 w-10 rounded-md object-cover"}):e.jsx("div",{className:"h-10 w-10 rounded-md bg-slate-200 dark:bg-slate-700 flex-shrink-0"}),e.jsx("span",{className:`font-medium text-slate-800 dark:text-slate-100 ${i?"cursor-pointer":""}`,onClick:i?()=>a(s.id):void 0,children:e.jsx(M,{highlightClassName:"bg-yellow-200 dark:bg-yellow-700 rounded-sm",searchWords:[g],autoEscape:!0,textToHighlight:s.name})})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(X,{status:s.status})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(k,{to:`/admin/categories/${s.id}/edit`,title:"Chỉnh sửa",className:"p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-500 hover:text-indigo-600 transition-colors",children:e.jsx(H,{size:16})}),e.jsx("button",{title:"Xóa",onClick:()=>h(s.id),className:"p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-500 hover:text-red-600 transition-colors",children:e.jsx(_,{size:16})})]})})]}),u&&i&&s.children.map(p=>e.jsx(w,{category:p,level:m+1,searchTerm:g,expandedIds:o,onToggle:a,onDelete:h},p.id))]})}const Q=()=>{const[s,m]=c.useState([]),[g,o]=c.useState(!0),[a,h]=c.useState({name:"",status:""}),{pop:d,conFim:i}=z(),[u,p]=c.useState([]),j=async()=>{o(!0);try{const t=await v.get("/admin/categories");m(t.data.data)}catch{d("Lỗi khi tải danh mục","e")}finally{o(!1)}};c.useEffect(()=>{j()},[d]);const f=(t,l,r)=>t.reduce((x,n)=>{const N=n.children?f(n.children,l,r):[],S=l?n.name.toLowerCase().includes(l.toLowerCase()):!0,L=r!==""?n.status.toString()===r:!0;return(S&&L||N.length>0)&&x.push({...n,children:N}),x},[]),b=c.useMemo(()=>f(s,a.name,a.status),[s,a]),y=t=>{p(l=>l.includes(t)?l.filter(r=>r!==t):[...l,t])},C=async t=>{var r,x;if(await i("Bạn có chắc chắn muốn xóa danh mục này? Mọi danh mục con cũng sẽ bị xóa."))try{(await v.delete(`/admin/categories/${t}`)).status===200&&(d("Xóa danh mục thành công!","s"),j())}catch(n){d(((x=(r=n.response)==null?void 0:r.data)==null?void 0:x.message)||"Xóa thất bại, đã có lỗi xảy ra.","e"),console.error("Error deleting category:",n)}};return e.jsxs("div",{className:"p-4 sm:p-6 bg-slate-50 dark:bg-slate-900 min-h-screen font-sans",children:[e.jsxs("header",{className:"flex flex-col sm:flex-row justify-between sm:items-center mb-6 gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-800 dark:text-slate-100",children:"Quản lý Danh mục"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:"Tổ chức và quản lý tất cả các danh mục sản phẩm."})]}),e.jsx(k,{to:"/admin/categories/new",children:e.jsxs("button",{className:"flex items-center justify-center gap-2 w-full sm:w-auto bg-indigo-600 text-white px-4 py-2.5 rounded-lg shadow-md hover:bg-indigo-700 transition-colors focus:ring-2 focus:ring-indigo-500",children:[e.jsx(P,{size:18}),"Thêm danh mục"]})})]}),e.jsx("div",{className:"p-4 bg-white dark:bg-slate-800 rounded-lg shadow-sm mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18}),e.jsx("input",{type:"text",placeholder:"Tìm theo tên danh mục...",value:a.name,onChange:t=>h({...a,name:t.target.value}),className:"w-full pl-10 pr-4 py-2 border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-700 text-sm focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("select",{name:"status",value:a.status,onChange:t=>h({...a,status:t.target.value}),className:"w-full px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-700 text-sm focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"",children:"Tất cả trạng thái"}),e.jsx("option",{value:"1",children:"Hoạt động"}),e.jsx("option",{value:"0",children:"Ẩn"})]})]})}),e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left text-slate-500 dark:text-slate-400",children:[e.jsx("thead",{className:"text-xs text-slate-700 dark:text-slate-300 uppercase bg-slate-50 dark:bg-slate-700/50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-4 py-3",children:"Tên danh mục"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Trạng thái"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-center",children:"Hành động"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:g?Array.from({length:5}).map((t,l)=>e.jsx("tr",{className:"animate-pulse",children:e.jsx("td",{className:"px-6 py-4",colSpan:"6",children:e.jsx("div",{className:"h-4 bg-slate-200 dark:bg-slate-700 rounded w-full"})})},l)):b.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:"3",className:"text-center py-16 text-slate-500",children:[e.jsx(R,{size:48,className:"mx-auto mb-2"}),"Không tìm thấy danh mục nào."]})}):b.map(t=>e.jsx(w,{category:t,searchTerm:a.name,expandedIds:u,onToggle:y,onDelete:C},t.id))})]})})]})};export{Q as default};
