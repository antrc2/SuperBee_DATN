import{r as p,j as s,L as y,h as k,s as N,E as _}from"./index-C2fgkNUe.js";import{y as l}from"./index-QFENNjq5.js";import{S as v}from"./save-4DflynXi.js";import{E}from"./eye-off-ByT157vR.js";const g=({value:r,onChange:d,name:m,placeholder:h,error:a,show:o,onToggle:i})=>s.jsxs("div",{children:[s.jsxs("div",{className:"relative",children:[s.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-secondary",children:s.jsx(N,{size:18})}),s.jsx("input",{type:o?"text":"password",name:m,value:r,onChange:d,placeholder:h,className:"w-full rounded-lg px-4 py-3 pl-12 pr-12 bg-input text-input border-themed border-hover placeholder-theme",required:!0}),s.jsx("button",{type:"button",onClick:i,className:"absolute right-4 top-1/2 -translate-y-1/2 text-secondary hover:text-primary",children:o?s.jsx(E,{size:18}):s.jsx(_,{size:18})})]}),a&&s.jsx("p",{className:"mt-1.5 text-sm text-red-500",children:a[0]})]});function z(){const[r,d]=p.useState({current_password:"",new_password:"",new_password_confirmation:""}),[m,h]=p.useState(!1),[a,o]=p.useState({}),[i,b]=p.useState({}),x=n=>{const{name:e,value:t}=n.target;d(c=>({...c,[e]:t})),o(c=>({...c,[e]:void 0}))},f=async n=>{n.preventDefault(),h(!0),o({});try{const e=await k.post("/user/change-password",r);e.status===200&&(l.success(e.data.message||"Đổi mật khẩu thành công!"),d({current_password:"",new_password:"",new_password_confirmation:""}))}catch(e){if(console.error("Error changing password:",e),e.response){const t=e.response.data.errors,c=e.response.data.message||"Đã có lỗi xảy ra.";if(l.error(c),t){o(t);for(const w in t)Array.isArray(t[w])?t[w].forEach(j=>l.error(j)):l.error(t[w])}}else l.error("Không thể kết nối đến máy chủ.")}finally{h(!1)}},u=n=>{b(e=>({...e,[n]:!e[n]}))};return s.jsxs("section",{className:"section-bg p-6 md:p-8 rounded-2xl shadow-lg",children:[s.jsxs("div",{className:"pb-6 border-b border-themed",children:[s.jsx("h1",{className:"font-heading text-2xl md:text-3xl font-bold text-primary",children:"Đổi mật khẩu"}),s.jsx("p",{className:"text-secondary mt-1",children:"Để đảm bảo an toàn, hãy sử dụng mật khẩu mạnh và không chia sẻ cho bất kỳ ai."})]}),s.jsxs("form",{onSubmit:f,className:"mt-8 max-w-lg mx-auto space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-secondary mb-2",children:"Mật khẩu hiện tại"}),s.jsx(g,{name:"current_password",value:r.current_password,onChange:x,placeholder:"Nhập mật khẩu hiện tại",error:a.current_password,show:i.current,onToggle:()=>u("current")})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-secondary mb-2",children:"Mật khẩu mới"}),s.jsx(g,{name:"new_password",value:r.new_password,onChange:x,placeholder:"Ít nhất 8 ký tự",error:a.new_password,show:i.new,onToggle:()=>u("new")})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-secondary mb-2",children:"Xác nhận mật khẩu mới"}),s.jsx(g,{name:"new_password_confirmation",value:r.new_password_confirmation,onChange:x,placeholder:"Nhập lại mật khẩu mới",error:a.new_password_confirmation,show:i.confirm,onToggle:()=>u("confirm")})]}),s.jsx("div",{className:"pt-2",children:s.jsxs("button",{type:"submit",disabled:m,className:"action-button action-button-primary",children:[s.jsx(v,{className:"h-5 w-5 mr-2"}),m?"Đang cập nhật...":"Cập nhật mật khẩu"]})})," ",s.jsx("p",{className:"text-sm font-normal",children:s.jsx(y,{to:"/forgot-password",className:"font-heading font-semibold transition-colors text-secondary hover:text-highlight",children:"Quên mật khẩu?"})})]})]})}export{z as default};
