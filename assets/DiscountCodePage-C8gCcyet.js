import{c as C,r as s,u as E,h as j,j as e,L as f,S as K,p as L,i as M,E as $,o as H}from"./index-C-Tm1Ach.js";import{u as B}from"./index-BSB541xQ.js";import{P as A}from"./plus-B9gQXaZ3.js";import{T as V}from"./tag-CBH1JsLk.js";import{T as q}from"./trash-2-c_Pyvyos.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]],G=C("chart-no-axes-column-increasing",F);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],R=C("undo-2",I),_=l=>l?new Date(l).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}):"N/A",U=({status:l,endDate:c})=>{const g=new Date,u=new Date(c)<g;let i="Không hoạt động",r="bg-slate-100 text-slate-800 dark:bg-slate-700 dark:text-slate-300";return l===1&&!u?(i="Hoạt động",r="bg-green-100 text-green-800 dark:bg-green-900/40 dark:text-green-300"):l===1&&u&&(i="Hết hạn",r="bg-yellow-100 text-yellow-800 dark:bg-yellow-900/40 dark:text-yellow-300"),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-semibold ${r}`,children:i})},Y=()=>{const[l,c]=s.useState([]),[g,u]=s.useState(null),[i,r]=s.useState(!0),[y,N]=s.useState(1),[k,S]=s.useState(""),[o,T]=s.useState({status:""}),[m,z]=s.useState({by:"created_at",direction:"desc"}),p=B(k,500),{pop:d,conFim:v}=E(),w=s.useCallback(async()=>{r(!0);try{const t={page:y,search:p,status:o.status,sort_by:m.by,sort_direction:m.direction};Object.keys(t).forEach(n=>t[n]===""&&delete t[n]);const a=await j.get("/admin/discountcode",{params:t});c(a.data.data.data),u(a.data.data)}catch{d("Lỗi khi tải danh sách mã giảm giá","e")}finally{r(!1)}},[y,p,o,m,d]);s.useEffect(()=>{w()},[w]),s.useEffect(()=>{N(1)},[p,o]);const D=async t=>{var n;if(await v("Bạn có chắc chắn muốn tắt mã giảm giá này không?"))try{const h=await j.delete(`/admin/discountcode/${t}`);(n=h.data)!=null&&n.data&&(c(x=>x.map(b=>b.id===t?{...b,...h.data.data}:b)),d("Tắt thành công","s"))}catch{d("Tắt thất bại!","e")}},P=async t=>{try{if(await v("Bạn có chắc chắn muốn Bật mã giảm giá này không?")){const n=await j.patch(`/admin/discountcode/${t}`);c(h=>h.map(x=>x.id===t?{...x,...n.data.data}:x)),d("Khôi phục thành công!","s")}}catch{d("Khôi phục thất bại!","e")}};return e.jsxs("div",{className:"p-4 sm:p-6 bg-slate-50 dark:bg-slate-900 min-h-screen font-sans",children:[e.jsxs("header",{className:"flex flex-col sm:flex-row justify-between sm:items-center mb-6 gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-800 dark:text-slate-100",children:"Quản lý Khuyến mãi"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:"Tạo và quản lý các mã giảm giá cho sản phẩm."})]}),e.jsx(f,{to:"/admin/discountcode/new",children:e.jsxs("button",{className:"flex items-center justify-center gap-2 w-full sm:w-auto bg-indigo-600 text-white px-4 py-2.5 rounded-lg shadow-md hover:bg-indigo-700 transition-colors focus:ring-2 focus:ring-indigo-500",children:[e.jsx(A,{size:18}),"Thêm mã mới"]})})]}),e.jsx("div",{className:"p-4 bg-white dark:bg-slate-800 rounded-lg shadow-sm mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(K,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18}),e.jsx("input",{type:"text",placeholder:"Tìm theo mã code...",value:k,onChange:t=>S(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-700 text-sm focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("select",{name:"status",value:o.status,onChange:t=>T({...o,status:t.target.value}),className:"w-full px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-700 text-sm focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"",children:"Tất cả trạng thái"}),e.jsx("option",{value:"1",children:"Đang hoạt động"}),e.jsx("option",{value:"0",children:"Không hoạt động"})]}),e.jsxs("select",{onChange:t=>{const[a,n]=t.target.value.split(",");z({by:a,direction:n})},defaultValue:"created_at,desc",className:"w-full px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-700 text-sm focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"created_at,desc",children:"Mới nhất"}),e.jsx("option",{value:"end_date,asc",children:"Sắp hết hạn"}),e.jsx("option",{value:"discount_value,desc",children:"Giảm giá: Cao đến thấp"})]})]})}),e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left text-slate-500 dark:text-slate-400",children:[e.jsx("thead",{className:"text-xs text-slate-700 dark:text-slate-300 uppercase bg-slate-50 dark:bg-slate-700/50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Mã Code"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Giá trị"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Mức sử dụng"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Hiệu lực"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Trạng thái"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-center",children:"Hành động"})]})}),e.jsx("tbody",{children:i?Array.from({length:5}).map((t,a)=>e.jsx("tr",{className:"animate-pulse",children:e.jsx("td",{className:"px-6 py-4",colSpan:"6",children:e.jsx("div",{className:"h-4 bg-slate-200 dark:bg-slate-700 rounded w-full"})})},a)):l.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:"6",className:"text-center py-16 text-slate-500",children:[e.jsx(V,{size:48,className:"mx-auto mb-2"}),"Không tìm thấy mã giảm giá nào."]})}):l.map(t=>e.jsxs("tr",{className:"bg-white dark:bg-slate-800 border-b dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 font-mono font-bold text-indigo-600 dark:text-indigo-400",children:t.code}),e.jsxs("td",{className:"px-6 py-4 font-semibold text-slate-800 dark:text-slate-100",children:[t.discount_value,"%"]}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{size:16,className:"text-slate-400"}),e.jsxs("span",{children:[t.total_used," /"," ",t.usage_limit===-1?"∞":t.usage_limit]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:_(t.start_date)}),e.jsx(L,{size:14}),e.jsx("span",{children:_(t.end_date)})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(U,{status:t.status,endDate:t.end_date})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[t.total_used>0?e.jsx("span",{className:"p-4"}):e.jsx(f,{to:`/admin/discountcode/${t.id}/edit`,title:"Chỉnh sửa",className:"p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-500 hover:text-indigo-600 transition-colors",children:e.jsx(M,{size:16})}),t.status===1?e.jsx("button",{title:"Vô hiệu hóa",onClick:()=>D(t.id),className:"p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-500 hover:text-red-600 transition-colors",children:e.jsx(q,{size:16})}):e.jsx("button",{title:"Khôi phục",onClick:()=>P(t.id),className:"p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-500 hover:text-green-600 transition-colors",children:e.jsx(R,{size:16})}),e.jsx(f,{to:`/admin/discountcode/${t.id}`,title:"Chỉnh sửa",className:"p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-500 hover:text-indigo-600 transition-colors",children:e.jsx($,{size:16})})]})})]},t.id))})]})}),!i&&g&&e.jsx(H,{meta:g,onPageChange:t=>N(t)})]})};export{Y as default};
