import{k as P,d as L,r as a,j as e,L as $,U as E,q as T,C as F,a as R,h as C}from"./index-DNv7UJt1.js";import{F as D}from"./funnel-CQvX1lyQ.js";function q(){const{categorySlug:o}=P(),c=L(),[m,x]=a.useState([]),[g,_]=a.useState([]),[i,h]=a.useState(1),[s,u]=a.useState(null),[k,p]=a.useState(!0),[f,b]=a.useState(null);a.useEffect(()=>{(async()=>{var r;try{const n=await C.get("/categoryPost");_(((r=n.data)==null?void 0:r.data)||[])}catch(n){console.error("Lỗi khi tải danh mục:",n)}})()},[]),a.useEffect(()=>{h(1)},[o]),a.useEffect(()=>{const t=o||"all";(async()=>{var N,w;p(!0),b(null);let n=t==="all"?`/post?page=${i}`:`/post/getcategory/${t}?page=${i}`;try{const l=(N=(await C.get(n)).data)==null?void 0:N.data;x((l==null?void 0:l.data)||[]),u({current_page:l.current_page,last_page:l.last_page})}catch(d){b("Đã xảy ra lỗi khi tải bài viết."),console.error("Lỗi chi tiết:",((w=d.response)==null?void 0:w.data)||d.message),x([]),u(null)}finally{p(!1)}})()},[o,i]);const y=a.useCallback(t=>{c(t==="all"?"/tin-tuc":`/tin-tuc/${t}`)},[c]),v=t=>{t>=1&&t<=(s==null?void 0:s.last_page)&&(h(t),window.scrollTo({top:0,behavior:"smooth"}))},S=g.reduce((t,r)=>(t[r.id]=r.slug||r.name.toLowerCase().replace(/\s+/g,"-"),t),{}),j=o||"all";return e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[e.jsx("aside",{className:"lg:w-64 lg:flex-shrink-0",children:e.jsxs("div",{className:"bg-input rounded-xl p-6 sticky top-8 shadow-themed",children:[e.jsxs("h3",{className:"font-heading text-lg font-bold text-primary mb-4 flex items-center",children:[e.jsx(D,{className:"h-5 w-5 mr-2 text-accent"}),"Danh mục"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{onClick:()=>y("all"),className:`w-full text-left px-4 py-2 rounded-lg text-sm font-semibold transition-all duration-300 ${j==="all"?"bg-accent text-accent-contrast shadow-md":"text-secondary hover:bg-tertiary hover:text-primary"}`,children:"Tất cả bài viết"}),g.map(t=>e.jsx("button",{onClick:()=>y(t.slug),className:`w-full text-left px-4 py-2 rounded-lg text-sm font-semibold transition-all duration-300 ${j===t.slug?"bg-accent text-accent-contrast shadow-md":"text-secondary hover:bg-tertiary hover:text-primary"}`,children:t.name},t.id))]})]})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[f&&e.jsx("div",{className:"alert alert-danger",children:f}),k?e.jsx("div",{className:"text-center py-10 text-secondary",children:"Đang tải..."}):m.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-8",children:m.map(t=>{var n;const r=S[t.category_id]||"uncategorized";return e.jsxs($,{to:`/tin-tuc/${r}/${t.slug}`,className:"bg-input rounded-xl overflow-hidden block group category-card-glow",children:[e.jsx("div",{className:"relative",children:e.jsx("img",{src:t.image_thumbnail_url||"/placeholder.svg",alt:t.title,className:"w-full h-48 object-cover transition-transform duration-300 group-hover:scale-105"})}),e.jsxs("div",{className:"p-5",children:[e.jsx("h3",{className:"font-heading text-lg font-bold text-primary mb-2 line-clamp-2 transition-colors duration-300 group-hover:text-accent",children:t.title}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-secondary mt-4",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(E,{className:"h-3 w-3 mr-1.5"}),((n=t.author)==null?void 0:n.username)||"Không rõ"]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(T,{className:"h-3 w-3 mr-1.5"}),new Date(t.created_at).toLocaleDateString("vi-VN")]})]})]})]},t.id)})}),s&&s.last_page>1&&e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsxs("button",{onClick:()=>v(s.current_page-1),disabled:s.current_page===1,className:"flex items-center px-4 py-2 text-sm font-semibold text-secondary bg-input border-themed rounded-lg transition-colors hover:border-hover hover:text-primary disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(F,{className:"h-4 w-4 mr-1"})," Trước"]}),e.jsxs("span",{className:"px-4 py-2 text-sm font-bold text-primary bg-input rounded-lg border-themed",children:[s.current_page," / ",s.last_page]}),e.jsxs("button",{onClick:()=>v(s.current_page+1),disabled:s.current_page===s.last_page,className:"flex items-center px-4 py-2 text-sm font-semibold text-secondary bg-input border-themed rounded-lg transition-colors hover:border-hover hover:text-primary disabled:opacity-50 disabled:cursor-not-allowed",children:["Sau ",e.jsx(R,{className:"h-4 w-4 ml-1"})]})]})]}):e.jsx("div",{className:"text-center py-10 text-secondary",children:"Không có bài viết nào để hiển thị."})]})]})})}export{q as default};
