import{c as y,r,j as e,U as E,P as D,X as S,h as j}from"./index-CfJ1g0mG.js";import{y as h}from"./index-B-Tq2T4L.js";import{M as L}from"./mail-BunRUv2K.js";import{S as U}from"./save-x90PbrpQ.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],F=y("camera",I);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]],P=y("pen-line",M),u=({icon:t,label:l,isEditing:n,...p})=>{const s=t;return e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-secondary mb-2",children:l}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-secondary",children:e.jsx(s,{size:18})}),e.jsx("input",{readOnly:!n,className:`w-full rounded-lg px-4 py-3 pl-12 bg-input text-input border-themed transition-all duration-200
                        ${n?"border-hover":"bg-background cursor-not-allowed"}`,...p})]})]})};function A(){const[t,l]=r.useState(!1),[n,p]=r.useState({username:"...",email:"",phone:"",avatar:""}),[s,o]=r.useState({}),[c,m]=r.useState(null),x=r.useRef(null),g=async()=>{try{const a=await j.get("/user/profile"),{username:i,email:d,phone:f,avatar:b}=a.data;p({username:i,email:d||"",phone:f||"",avatar:b||""}),o({email:d||"",phone:f||"",avatar:b||""})}catch(a){console.error("Error fetching user data:",a),h.error("Không thể tải thông tin người dùng.")}},v=async()=>{try{const a=new FormData;a.append("email",s.email),a.append("phone",s.phone),c?a.append("avatar",c):a.append("avatar_url",s.avatar),await j.post("/user/profile-update",a,{headers:{"Content-Type":"multipart/form-data"}}),await g(),l(!1),m(null),h.success("Cập nhật thông tin thành công!")}catch(a){if(console.error("Error updating user data:",a),a.response&&a.response.status===422){const i=a.response.data.errors;for(const d in i)h.error(i[d][0])}else h.error("Cập nhật thông tin thất bại. Vui lòng thử lại.")}};r.useEffect(()=>{g()},[]);const N=()=>{l(!0),o({...n}),m(null)},w=()=>{l(!1)},k=async()=>{await v()},C=()=>{var a;return(a=x.current)==null?void 0:a.click()};return e.jsxs("section",{className:"section-bg p-6 md:p-8 rounded-2xl shadow-lg",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between pb-6 border-b border-themed",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"font-heading text-2xl md:text-3xl font-bold text-primary",children:"Thông tin tài khoản"}),e.jsx("p",{className:"text-secondary mt-1",children:"Quản lý và bảo mật thông tin cá nhân của bạn."})]}),!t&&e.jsxs("button",{onClick:N,className:"action-button action-button-primary mt-4 sm:mt-0 !w-auto",children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Chỉnh sửa"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 pt-8",children:[e.jsxs("div",{className:"lg:col-span-1 flex flex-col items-center text-center",children:[e.jsxs("div",{className:"relative group w-40 h-40",children:[e.jsx("img",{src:c?URL.createObjectURL(c):n.avatar||"/default-avatar.png",alt:"Avatar",className:"w-full h-full object-cover rounded-full ring-4 ring-offset-4 ring-offset-content-bg ring-accent/70"}),t&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:C,className:"absolute inset-0 bg-black/60 rounded-full flex items-center justify-center text-white opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer",children:e.jsx(F,{size:24})}),e.jsx("input",{type:"file",ref:x,className:"hidden",accept:"image/*",onChange:a=>m(a.target.files[0])})]})]}),e.jsx("p",{className:"text-secondary text-sm mt-4",children:"Ảnh đại diện của bạn."})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsx(u,{icon:E,label:"Tên đăng nhập",isEditing:!1,value:n.username,placeholder:"Tên đăng nhập"}),e.jsx(u,{icon:L,label:"Địa chỉ Email",isEditing:t,name:"email",type:"email",value:t?s.email:n.email,onChange:a=>o({...s,email:a.target.value}),placeholder:"example@email.com"}),e.jsx(u,{icon:D,label:"Số điện thoại",isEditing:t,name:"phone",type:"tel",value:t?s.phone:n.phone,onChange:a=>o({...s,phone:a.target.value}),placeholder:"0123 456 789"}),t&&e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsxs("button",{onClick:w,className:"action-button action-button-secondary !w-auto",children:[e.jsx(S,{className:"h-4 w-4 mr-2"}),"Hủy"]}),e.jsxs("button",{onClick:k,className:"action-button action-button-primary !w-auto",children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Lưu thay đổi"]})]})]})]})]})}export{A as default};
