import{r as t,m as w,d as v,j as e,aK as N,aN as S,h as E,E as P}from"./index-b9nMIW9s.js";import{E as C}from"./eye-off-CIbHo40V.js";const b=({label:c,value:d,onChange:u,error:a,...n})=>{const[o,i]=t.useState(!1);return e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-secondary mb-2",children:c}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:o?"text":"password",value:d,onChange:u,required:!0,className:`w-full rounded-lg px-4 py-3 bg-input text-input border-themed pr-12 ${a?"border-red-500":"border-hover"}`,...n}),e.jsx("button",{type:"button",onClick:()=>i(!o),className:"absolute right-4 top-1/2 -translate-y-1/2 text-secondary hover:text-primary",children:o?e.jsx(C,{size:18}):e.jsx(P,{size:18})})]}),a&&e.jsx("p",{className:"mt-1.5 text-sm text-red-500",children:a[0]})]})},R=()=>{const[c,d]=t.useState(""),[u,a]=t.useState(""),[n,o]=t.useState(""),[i,p]=t.useState(""),[m,l]=t.useState(""),[x,g]=t.useState({}),[f,h]=t.useState(!1),y=w(),k=v();t.useEffect(()=>{const s=new URLSearchParams(y.search).get("token");s?o(s):l("Không tìm thấy mã đặt lại mật khẩu trong liên kết.")},[y.search]);const j=async r=>{if(r.preventDefault(),p(""),l(""),g({}),h(!0),!n){l("Mã đặt lại mật khẩu không hợp lệ."),h(!1);return}try{const s=await E.post("/reset-password",{token:n,password:c,password_confirmation:u});p(s.data.message),d(""),a(""),setTimeout(()=>k("/auth/login"),3e3)}catch(s){s.response?s.response.status===422&&s.response.data.errors?g(s.response.data.errors):l(s.response.data.message||"Đã xảy ra lỗi khi đặt lại mật khẩu."):l("Không thể kết nối đến máy chủ. Vui lòng kiểm tra lại đường truyền.")}finally{h(!1)}};return e.jsxs(N,{title:"Đặt lại mật khẩu",icon:S,children:[i&&e.jsx("div",{className:"alert alert-success mb-4",children:i}),m&&e.jsx("div",{className:"alert alert-danger mb-4",children:m}),n?e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsx(b,{label:"Mật khẩu mới",value:c,onChange:r=>d(r.target.value),placeholder:"Ít nhất 8 ký tự",error:x.password}),e.jsx(b,{label:"Xác nhận mật khẩu",value:u,onChange:r=>a(r.target.value),placeholder:"Nhập lại mật khẩu mới",error:x.password_confirmation}),e.jsx("div",{className:"pt-2",children:e.jsx("button",{type:"submit",disabled:f,className:"action-button action-button-primary",children:f?"Đang xử lý...":"Đặt lại mật khẩu"})})]}):!i&&!m&&e.jsx("p",{className:"text-secondary text-center",children:"Đang kiểm tra liên kết..."})]})};export{R as default};
