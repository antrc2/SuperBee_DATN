import{j as e,aP as b,f as j,au as y,r as g,X as f,h as v}from"./index-BbqGDQoq.js";import{P as N}from"./Product-C-z3-bpG.js";import{B as w}from"./Breadcrumbs-3XMV07Oq.js";import{F as k}from"./funnel-DHZAZ8Pv.js";import"./recharge-7Wy_Gsf5.js";function _(){return e.jsxs("div",{className:"bg-content rounded-xl border border-themed overflow-hidden h-full animate-pulse",children:[e.jsx("div",{className:"h-[160px] bg-primary/10"}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsx("div",{className:"h-4 bg-primary/20 rounded w-3/4"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-3 bg-primary/10 rounded w-full"}),e.jsx("div",{className:"h-3 bg-primary/10 rounded w-5/6"})]}),e.jsxs("div",{className:"flex justify-between items-center pt-2",children:[e.jsx("div",{className:"h-6 bg-highlight/20 rounded w-1/3"}),e.jsx("div",{className:"h-8 w-8 bg-highlight/20 rounded-full"})]})]})]})}function S({categories:a,initialFilters:l,onApplyFilters:i}){const[c,r]=g.useState(l);g.useEffect(()=>{r(l)},[l]);const s=n=>{const{name:d,value:u}=n.target;r(x=>({...x,[d]:u}))},m=()=>{i(c)},p=()=>{const n={key:"",sku:"",categoryId:"",min_price:"",max_price:"",sortBy:"newest",page:1};r(n),i(n)};return e.jsx("aside",{className:"w-full lg:w-1/4 space-y-6",children:e.jsxs("div",{className:"bg-content p-6 rounded-xl border-themed space-y-4",children:[e.jsxs("h3",{className:"font-heading text-xl font-semibold text-primary flex items-center gap-2",children:[e.jsx(k,{className:"text-highlight"}),"Bộ Lọc Tìm Kiếm"]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sku",className:"block text-sm font-medium text-primary mb-1",children:"Mã sản phẩm (SKU)"}),e.jsx("input",{type:"text",id:"sku",name:"sku",value:c.sku||"",onChange:s,placeholder:"Nhập mã SKU...",className:"block w-full px-4 py-2 text-sm rounded-lg border-hover bg-input text-input"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"categoryId",className:"block text-sm font-medium text-primary mb-1",children:"Danh mục game"}),e.jsxs("select",{id:"categoryId",name:"categoryId",value:c.categoryId||"",onChange:s,className:"block w-full px-4 py-2 text-sm rounded-lg border-hover bg-input text-input",children:[e.jsx("option",{value:"",children:"Tất cả danh mục"}),a.map(n=>e.jsx("optgroup",{label:n.name,children:n.children.map(d=>e.jsx("option",{value:d.id,children:d.name},d.id))},n.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary mb-1",children:"Khoảng giá"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",name:"min_price",value:c.min_price||"",onChange:s,placeholder:"Từ",className:"block w-full px-4 py-2 text-sm rounded-lg border-hover bg-input text-input"}),e.jsx("input",{type:"number",name:"max_price",value:c.max_price||"",onChange:s,placeholder:"Đến",className:"block w-full px-4 py-2 text-sm rounded-lg border-hover bg-input text-input"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 pt-2",children:[e.jsx("button",{onClick:m,className:"action-button action-button-primary flex-1",children:"Áp dụng"}),e.jsx("button",{onClick:p,className:"action-button action-button-secondary p-3",children:e.jsx(f,{size:16})})]})]})})}const P=a=>y({queryKey:["products_search",a],queryFn:async()=>{const l=Object.fromEntries(Object.entries(a).filter(([r,s])=>s!=null&&s!=="")),i=new URLSearchParams(l),{data:c}=await v.get(`/home/products?${i}`);return c},keepPreviousData:!0});function L(){var x;const[a,l]=b(),{homeData:i}=j(),c=((x=i==null?void 0:i.categories)==null?void 0:x.treeCategories)||[],r={key:a.get("key")||"",sku:a.get("sku")||"",categoryId:a.get("categoryId")||"",min_price:a.get("min_price")||"",max_price:a.get("max_price")||"",sortBy:a.get("sortBy")||"newest",page:parseInt(a.get("page")||"1",10)},{data:s,isLoading:m}=P(r),p=t=>{t.page=1,l(t)},n=t=>{const o=t.target.value,h=new URLSearchParams(a);h.set("sortBy",o),h.set("page","1"),l(h)},d=t=>{if(t&&t!==r.page){const o=new URLSearchParams(a);o.set("page",t),l(o)}},u=[{label:"Trang chủ",href:"/"},{label:"Tìm kiếm sản phẩm"}];return e.jsxs("div",{className:"max-w-screen-xl mx-auto min-h-screen ",children:[e.jsx(w,{items:u}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8 mt-6",children:[e.jsx(S,{categories:c,initialFilters:r,onApplyFilters:p}),e.jsxs("main",{className:"w-full lg:w-3/4 px-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-4 bg-content p-3 rounded-xl border-themed",children:[e.jsxs("div",{className:"text-sm text-secondary mb-2 sm:mb-0",children:[e.jsx("span",{children:"Tìm thấy "}),e.jsx("strong",{className:"text-primary",children:(s==null?void 0:s.total)||0}),e.jsx("span",{children:" kết quả"}),r.key&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:" cho "}),e.jsxs("strong",{className:"text-highlight",children:['"',r.key,'"']})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{htmlFor:"sortBy",className:"text-sm font-medium text-primary",children:"Sắp xếp:"}),e.jsxs("select",{id:"sortBy",name:"sortBy",value:r.sortBy,onChange:n,className:"text-sm rounded-lg border-hover bg-input text-input p-2",children:[e.jsx("option",{value:"newest",children:"Mới nhất"}),e.jsx("option",{value:"featured",children:"Nổi bật"}),e.jsx("option",{value:"price_asc",children:"Giá: Thấp đến Cao"}),e.jsx("option",{value:"price_desc",children:"Giá: Cao đến Thấp"})]})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-3 gap-4",children:m?Array.from({length:12}).map((t,o)=>e.jsx(_,{},o)):s==null?void 0:s.data.map(t=>e.jsx(N,{product:t},t.id))}),!m&&(s==null?void 0:s.data.length)===0&&e.jsx("div",{className:"text-center py-16 bg-content rounded-lg",children:e.jsx("p",{className:"text-secondary",children:"Không tìm thấy sản phẩm nào."})}),s&&s.last_page>1&&e.jsx("div",{className:"flex justify-center items-center gap-2 mt-8",children:s.links.map((t,o)=>{const h=t.url?new URL(t.url).searchParams.get("page"):null;return e.jsx("button",{onClick:()=>d(h),disabled:!t.url||m,dangerouslySetInnerHTML:{__html:t.label},className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${t.active?"bg-primary text-white shadow-md":"bg-card hover:bg-gray-200 dark:hover:bg-gray-700"} ${t.url?"":"text-gray-400 cursor-not-allowed opacity-50"}`},o)})})]})]})]})}export{L as default};
