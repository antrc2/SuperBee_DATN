import{y as _,l as L,u as C,r as o,j as e,o as M,m as j,e as A}from"./index-BDAcJp4Y.js";const S=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5 mr-2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})}),I=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5 mr-2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})}),k=()=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 003.741-.479 3 3 0 00-4.682-2.72m-7.5-2.962c.51.054.994.093 1.485.127a18.154 18.154 0 010 2.863m-7.5 0a9.094 9.094 0 013.741-.479 3 3 0 014.682-2.72M13.5 5.25h3V7.5h-3V5.25zm-8.25 5.25h3V13.5h-3V10.5z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),K=()=>e.jsx("svg",{className:"w-4 h-4 text-gray-400","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 20",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"})}),a=({label:l,value:r,children:d,className:t=""})=>r===null||r===void 0&&!d?null:e.jsxs("div",{className:`px-4 py-4 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6 ${t}`,children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:l}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 dark:text-white sm:col-span-2 sm:mt-0",children:d||r})]}),V=({status:l})=>{const r=l===1,d=r?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300";return e.jsx("span",{className:`px-3 py-1 text-xs font-medium rounded-full ${d}`,children:r?"Kích hoạt":"Ẩn"})},D=()=>{var y;const{id:l}=_(),r=L(),{pop:d}=C(),[t,f]=o.useState(null),[b,p]=o.useState(!0),[v,x]=o.useState(!1),[c,N]=o.useState("");o.useEffect(()=>{(async()=>{try{const n=await A.get(`/admin/discountcode/${l}`);f(n.data.data)}catch{d("Không thể tải thông tin khuyến mãi.","e"),r("/admin/discountcode")}finally{p(!1)}})()},[l,r,d]);const m=o.useMemo(()=>{if(!(t!=null&&t.promotion_user))return[];if(!c)return t.promotion_user;const s=c.toLowerCase();return t.promotion_user.filter(({user:n})=>n.username.toLowerCase().includes(s)||n.email.toLowerCase().includes(s))},[c,t]),h=s=>s==null?"N/A":new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(s),g=s=>s?new Date(s).toLocaleString("vi-VN",{dateStyle:"long",timeStyle:"short"}):"N/A";if(b)return e.jsx(M,{});if(!t)return e.jsx("div",{className:"flex justify-center items-center h-screen bg-slate-50 dark:bg-gray-900 text-red-500",children:"Không có dữ liệu để hiển thị."});const w=t.promotion_user_id===-1||!t.promotion_user||t.promotion_user.length===0,i=t.user,u=({user:s})=>e.jsxs("div",{className:"p-4 flex items-center space-x-4",children:[e.jsx("img",{className:"h-12 w-12 rounded-full object-cover bg-gray-100",src:s.avatar_url,alt:`Avatar of ${s.username}`,onError:n=>{n.target.onerror=null,n.target.src="https://placehold.co/48x48/e2e8f0/64748b?text=U"}}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900 dark:text-white truncate",children:s.username}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:s.email})]}),e.jsx(j,{to:`/admin/users/${s.id}`,className:"flex-shrink-0 text-xs font-medium text-sky-600 hover:text-sky-800 dark:text-sky-400 dark:hover:text-sky-200 hover:underline",children:"Xem"})]},s.id);return e.jsxs("div",{className:"font-sans bg-slate-50 dark:bg-gray-900 min-h-screen p-4 sm:p-6 lg:p-8",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsxs("button",{type:"button",onClick:()=>r(-1),className:"flex items-center text-sm font-medium text-gray-600 hover:text-sky-600 dark:text-gray-400 dark:hover:text-sky-400 mb-2",children:[e.jsx(S,{}),"Quay lại danh sách"]}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Chi tiết Khuyến Mãi"})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsxs(j,{to:`/admin/discountcode/${l}/edit`,className:"w-full sm:w-auto inline-flex justify-center items-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-lg text-white bg-sky-600 hover:bg-sky-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-sky-500 dark:focus:ring-offset-gray-900",children:[e.jsx(I,{}),"Chỉnh sửa"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-xl rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-5 sm:px-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("h3",{className:"text-xl leading-6 font-bold text-gray-900 dark:text-white",children:["Mã:"," ",e.jsx("span",{className:"font-mono text-sky-600 dark:text-sky-400",children:t.code})]}),e.jsx("p",{className:"mt-1 max-w-2xl text-sm text-gray-500 dark:text-gray-400",children:t.description||"Không có mô tả."})]}),e.jsxs("dl",{children:[e.jsx(a,{label:"Trạng thái",className:"bg-gray-50 dark:bg-gray-800/50",children:e.jsx(V,{status:t.status})}),e.jsx(a,{label:"Phần trăm giảm",value:`${t.discount_value}%`}),e.jsx(a,{label:"Ngày bắt đầu",value:g(t.start_date),className:"bg-gray-50 dark:bg-gray-800/50"}),e.jsx(a,{label:"Ngày kết thúc",value:g(t.end_date)}),e.jsx(a,{label:"Tổng lượt đã dùng",value:t.total_used,className:"bg-gray-50 dark:bg-gray-800/50"}),e.jsx(a,{label:"Tổng lượt sử dụng",value:t.usage_limit===-1?"Không giới hạn":t.usage_limit}),e.jsx(a,{label:"Lượt dùng/Người",value:t.per_user_limit===-1?"Không giới hạn":t.per_user_limit,className:"bg-gray-50 dark:bg-gray-800/50"}),e.jsx(a,{label:"Giảm tối thiểu",value:h(t.min_discount_amount)}),e.jsx(a,{label:"Giảm tối đa",value:h(t.max_discount_amount),className:"bg-gray-50 dark:bg-gray-800/50"})]})]})}),e.jsxs("div",{className:"lg:col-span-1 space-y-8",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-xl rounded-lg overflow-hidden",children:[e.jsx("div",{className:"p-5 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"text-lg font-semibold leading-6 text-gray-900 dark:text-gray-100 flex items-center",children:"Đối tượng áp dụng"})}),w?e.jsxs("div",{className:"p-6 flex flex-col items-center justify-center text-center",children:[e.jsx("div",{className:"p-3 bg-sky-100 dark:bg-sky-900/50 rounded-full",children:e.jsx(k,{className:"w-8 h-8 text-sky-600 dark:text-sky-400"})}),e.jsx("p",{className:"mt-4 font-semibold text-gray-800 dark:text-gray-200",children:"Tất cả người dùng"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Mã này áp dụng cho mọi khách hàng."})]}):t.promotion_user.length>5?e.jsxs("div",{className:"p-6 text-center",children:[e.jsx("div",{className:"p-3 bg-indigo-100 dark:bg-indigo-900/50 rounded-full inline-block",children:e.jsx(k,{className:"w-8 h-8 text-indigo-600 dark:text-indigo-400"})}),e.jsxs("p",{className:"mt-4 font-semibold text-gray-800 dark:text-gray-200",children:["Áp dụng cho ",t.promotion_user.length," người dùng"]}),e.jsx("button",{onClick:()=>x(!0),className:"mt-2 text-sm font-medium text-sky-600 hover:text-sky-800 dark:text-sky-400 dark:hover:text-sky-200 hover:underline",children:"Xem chi tiết →"})]}):e.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:t.promotion_user.map(({user:s})=>e.jsx(u,{user:s},s.id))})]}),i&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-xl rounded-lg overflow-hidden",children:[e.jsx("div",{className:"p-5 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"text-lg font-semibold leading-6 text-gray-900 dark:text-gray-100 flex items-center",children:"Người tạo"})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("img",{className:"h-16 w-16 rounded-full object-cover",src:i.avatar_url,alt:`Avatar of ${i.username}`,onError:s=>{s.target.onerror=null,s.target.src="https://placehold.co/64x64/e2e8f0/64748b?text=User"}}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-bold text-gray-900 dark:text-white",children:i.username}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:i.email})]})]}),e.jsx("div",{className:"mt-4 border-t border-gray-200 dark:border-gray-700 pt-4",children:e.jsxs("dl",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("dt",{className:"text-gray-500 dark:text-gray-400",children:"Website"}),e.jsx("dd",{className:"text-gray-700 dark:text-gray-300 font-mono",children:((y=i.web)==null?void 0:y.subdomain)||"N/A"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("dt",{className:"text-gray-500 dark:text-gray-400",children:"Ngày tạo"}),e.jsx("dd",{className:"text-gray-700 dark:text-gray-300",children:g(t.created_at)})]})]})})]})]})]})]})]}),v&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",onClick:()=>x(!1),children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-2xl w-full max-w-2xl max-h-[80vh] flex flex-col",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"p-5 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:["Danh sách người dùng (",t.promotion_user.length,")"]}),e.jsx("button",{onClick:()=>x(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 text-2xl leading-none",children:"×"})]}),e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(K,{})}),e.jsx("input",{type:"text",placeholder:"Tìm theo tên hoặc email...",value:c,onChange:s=>N(s.target.value),className:"block w-full pl-10 pr-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500 dark:text-white"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto divide-y divide-gray-200 dark:divide-gray-700",children:m.length>0?m.map(({user:s})=>e.jsx(u,{user:s},s.id)):e.jsx("p",{className:"text-center text-gray-500 p-8",children:"Không tìm thấy người dùng nào."})})]})})]})};export{D as default};
