import{j as e,m as T,E as B,_ as R,O as D,u as A,l as U,B as O,r as i,e as N,o as V,w as H,J as q}from"./index-BDAcJp4Y.js";import{K as I}from"./key-BNt8mYUy.js";import{P as J}from"./plus-Do1uWJo7.js";import{R as X,C as Q}from"./rotate-ccw-BijtejJR.js";function W({products:l,handleKey:g,handleLock:o}){return l.length===0?e.jsx("div",{className:"p-10 text-center text-sm text-gray-500 dark:text-gray-400",children:"Không tìm thấy sản phẩm nào."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm text-left text-gray-500 dark:text-gray-400",children:[e.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-300",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"py-3 px-6",children:"SKU"}),e.jsx("th",{scope:"col",className:"py-3 px-6",children:"Tên sản phẩm"}),e.jsx("th",{scope:"col",className:"py-3 px-6",children:"Giá"}),e.jsx("th",{scope:"col",className:"py-3 px-6",children:"Trạng thái"}),e.jsx("th",{scope:"col",className:"py-3 px-6 text-center",children:"Hành động"})]})}),e.jsx("tbody",{children:l.map(t=>e.jsxs("tr",{className:"bg-white dark:bg-gray-800 border-b dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600/50 transition-colors",children:[e.jsx("td",{className:"py-4 px-6 font-medium text-gray-900 dark:text-white whitespace-nowrap",children:t.sku}),e.jsxs("td",{className:"py-4 px-6",children:["Sản phẩm #",t.id]}),e.jsxs("td",{className:"py-4 px-6",children:[t.price.toLocaleString(),"đ"]}),e.jsx("td",{className:"py-4 px-6",children:e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${t.status===1?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":t.status===2?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300":t.status===3?"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300":t.status===4?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300":"bg-violet-100 text-violet-800 dark:bg-violet-900 dark:text-violet-300"}`,children:t.status===1?"Đang bán":t.status===2?"Chờ duyệt":t.status===3?"Không Bán":t.status===4?"Bán thành công":"Bị từ chối"})}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"flex justify-center items-center gap-4",children:[e.jsx(T,{to:`/admin/products/${t.id}`,title:"Xem chi tiết",children:e.jsx(B,{className:"text-gray-400 hover:text-green-600 dark:hover:text-green-400 cursor-pointer",size:20})}),t.status===4||t.status==0?e.jsx("span",{className:"px-7"}):e.jsxs(e.Fragment,{children:[e.jsx(T,{to:`/admin/products/${t.id}/edit`,title:"Chỉnh sửa",children:e.jsx(R,{className:"text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 cursor-pointer",size:20})}),t.status===1?e.jsx("button",{onClick:()=>o(t.id),title:"Hủy Bán",children:e.jsx(D,{className:"text-gray-400 hover:text-red-600 dark:hover:text-red-400 cursor-pointer",size:20})}):e.jsx("button",{onClick:()=>g(t.id),title:"Bán Lại",children:e.jsx(I,{className:"text-gray-400 hover:text-yellow-600 dark:hover:text-yellow-400 cursor-pointer",size:20})})]})]})})]},t.id))})]})})}const Y=(l,g)=>{const[o,t]=i.useState(l);return i.useEffect(()=>{const y=setTimeout(()=>{t(l)},g);return()=>{clearTimeout(y)}},[l,g]),o},se=()=>{const{pop:l,conFim:g}=A(),o=U(),t=O(),[y,K]=i.useState([]),[b,P]=i.useState(null),[L,v]=i.useState(!0),[w,C]=i.useState(null),n=i.useMemo(()=>new URLSearchParams(t.search),[t.search]),f=i.useMemo(()=>{const a={};for(const[s,r]of n.entries())s!=="page"&&(a[s]=r);return a},[n]),[d,j]=i.useState(f),[m,_]=i.useState(n.get("search")||""),p=Y(m,500),k=i.useCallback(async()=>{v(!0);try{const a=await N.get("/admin/products",{params:n}),{data:s,...r}=a.data.data;K(s),P(r)}catch{l("Lấy dữ liệu thất bại","e")}finally{v(!1)}},[t.search,l]);i.useEffect(()=>{(async()=>{try{const r=(await N.get("/categories")).data.data.onlyChildren.map(c=>({label:c.name,value:c.id.toString()})),h={type:"select",name:"category_id",label:"Danh mục",options:[{label:"Tất cả",value:""},...r]};C([h,{type:"select",name:"status",label:"Trạng thái",options:[{label:"Tất cả",value:""},{label:"Đang bán",value:"1"},{label:"Không bán",value:"3"},{label:"Bán thành công",value:"4"},{label:"Bị từ chối",value:"0"}]},{type:"number_range",name:"price",label:"Khoảng giá",minName:"price_min",maxName:"price_max",placeholderMin:"Giá từ",placeholderMax:"Giá đến"}])}catch{l("Không thể tải cấu hình bộ lọc","e"),C([{type:"select",name:"status",label:"Trạng thái",options:[{label:"Tất cả",value:""}]},{type:"number_range",name:"price",label:"Khoảng giá",minName:"price_min",maxName:"price_max",placeholderMin:"Giá từ",placeholderMax:"Giá đến"}])}})()},[l]),i.useEffect(()=>{k()},[k]),i.useEffect(()=>{const a=n.get("search")||"";p!==a&&(p?n.set("search",p):n.delete("search"),n.set("page","1"),o({search:n.toString()}))},[p,n,o]),i.useEffect(()=>{j(f)},[f]);const M=(a,s)=>{j(r=>({...r,[a]:s}))},F=(a,s,r)=>{const h=r.slice(0,15),x=`${a}_${s}`;j(u=>({...u,[x]:h}))},E=()=>{const{price_min:a,price_max:s}=d;if(a&&s){const r=parseFloat(a),h=parseFloat(s);if(r>=h){l("Giá trị 'Giá từ' phải nhỏ hơn 'Giá đến'.","e");return}}Object.keys(d).forEach(r=>{d[r]?n.set(r,d[r]):n.delete(r)}),m&&n.set("search",m),n.set("page","1"),o({search:n.toString()})},G=()=>{const a=new URLSearchParams;m&&a.set("search",m),o({search:a.toString()})},$=a=>{n.set("page",a),o({search:n.toString()})},z=()=>o("/admin/products/new"),S=async(a,s,r)=>{var x,u;if(await g(r))try{const c=`/admin/products/${s}/${a}`;await N.post(c),l(`${a==="restore"?"Kích hoạt":"Khóa"} sản phẩm thành công`,"s"),k()}catch(c){l(`Thực hiện thất bại: ${((u=(x=c==null?void 0:c.response)==null?void 0:x.data)==null?void 0:u.message)||c.message}`,"e")}};return L||!w?e.jsx(V,{}):e.jsx("div",{className:"flex-1 bg-gray-100 dark:bg-gray-900 transition-colors duration-200",children:e.jsxs("main",{className:"p-4 sm:p-6 lg:p-8 space-y-6",children:[e.jsxs("header",{className:"flex flex-col sm:flex-row items-start sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-gray-100",children:"Danh sách tài khoản game"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Thêm, xem, và quản lý các sản phẩm của bạn."})]}),e.jsx("div",{className:"flex w-full sm:w-auto items-center gap-2",children:e.jsxs("button",{onClick:z,className:"flex w-full sm:w-auto items-center justify-center gap-2 bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors shadow-sm",children:[e.jsx(J,{size:18}),e.jsx("span",{className:"hidden sm:inline",children:"Thêm mới"})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm border dark:border-gray-700",children:[e.jsxs("div",{className:"relative flex-grow",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:e.jsx(H,{className:"text-gray-400",size:18})}),e.jsx("input",{type:"text",placeholder:"Tìm kiếm theo SKU...",value:m,onChange:a=>_(a.target.value),className:"w-full pl-10 p-2 text-sm text-gray-900 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition"})]}),e.jsxs("div",{className:"mt-4 border-t dark:border-gray-700 pt-4",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:w.map(a=>e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:a.name,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:a.label}),a.type==="number_range"?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",name:a.minName,placeholder:a.placeholderMin,value:d[a.minName]||"",onChange:s=>F(a.name,"min",s.target.value),max:"999999999999999",min:"0",className:"w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-200 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:focus:ring-indigo-400 transition"}),e.jsx("span",{className:"text-gray-500",children:"-"}),e.jsx("input",{type:"number",name:a.maxName,placeholder:a.placeholderMax,value:d[a.maxName]||"",onChange:s=>F(a.name,"max",s.target.value),max:"999999999999999",min:"0",className:"w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-200 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:focus:ring-indigo-400 transition"})]}):e.jsx("select",{id:a.name,name:a.name,value:d[a.name]||"",onChange:s=>M(a.name,s.target.value),className:"px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-200 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:focus:ring-indigo-400 transition",children:a.options.map((s,r)=>e.jsx("option",{value:s.value,className:"dark:bg-gray-700 dark:text-gray-200",children:s.label},r))})]},a.name))}),e.jsxs("div",{className:"mt-4 flex justify-end gap-3",children:[e.jsxs("button",{onClick:G,className:"flex items-center gap-2 px-4 py-2 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-100 rounded-md hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors focus:outline-none focus:ring-2 focus:ring-gray-400",children:[e.jsx(X,{size:16})," Reset"]}),e.jsxs("button",{onClick:E,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800",children:[e.jsx(Q,{size:18})," Áp dụng"]})]})]})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border dark:border-gray-700 overflow-hidden",children:e.jsx(W,{products:y,handleKey:a=>S("restore",a,"Kích hoạt lại sản phẩm này?"),handleLock:a=>S("cancel",a,"Khóa sản phẩm này?")})}),b&&b.last_page>1&&e.jsx("div",{className:"bg-white dark:bg-gray-800 shadow-sm rounded-lg border dark:border-gray-700 py-3 px-4",children:e.jsx(q,{meta:b,onPageChange:$})})]})})};export{se as default};
