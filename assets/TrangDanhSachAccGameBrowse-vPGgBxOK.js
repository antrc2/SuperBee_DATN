import{j as e,L as C,E,u as R,r as n,d as B,m as F,h as N,g as T}from"./index-BbqGDQoq.js";import{L as A}from"./Layout-BgRv6mNM.js";import{P as w}from"./filterConfigs-C5yZOpH0.js";import"./plus-Bv_wG-CX.js";import"./funnel-DHZAZ8Pv.js";function U({products:h}){const m=s=>{switch(s){case 1:return{text:"Đang bán",className:"bg-green-100 text-green-800 dark:bg-green-500/20 dark:text-green-400"};case 2:return{text:"Chờ duyệt",className:"bg-yellow-100 text-yellow-800 dark:bg-yellow-500/20 dark:text-yellow-400"};case 3:return{text:"Đã hủy",className:"bg-red-100 text-red-800 dark:bg-red-500/20 dark:text-red-400"};case 4:return{text:"Bán thành công",className:"bg-blue-100 text-blue-800 dark:bg-blue-500/20 dark:text-blue-400"};default:return{text:"Bị từ chối",className:"bg-gray-100 text-gray-800 dark:bg-gray-500/20 dark:text-gray-400"}}};return e.jsx("div",{className:"overflow-x-auto rounded-lg border border-gray-200 dark:border-gray-700",children:e.jsxs("table",{className:"min-w-full bg-white dark:bg-gray-900 text-gray-900 dark:text-white",children:[e.jsx("thead",{className:"bg-gray-100 dark:bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-3 px-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider dark:text-gray-300",children:"SKU"}),e.jsx("th",{className:"py-3 px-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider dark:text-gray-300",children:"Tên sản phẩm (Tạm)"}),e.jsx("th",{className:"py-3 px-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider dark:text-gray-300",children:"Giá bán"}),e.jsx("th",{className:"py-3 px-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider dark:text-gray-300",children:"Trạng thái"}),e.jsx("th",{className:"py-3 px-4 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider dark:text-gray-300",children:"Hành động"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:h.map(s=>{var c,i;const o=m(s.status);return e.jsxs("tr",{className:"hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200",children:[e.jsx("td",{className:"py-4 px-4 text-sm text-gray-500 dark:text-gray-300 font-mono",children:s.sku}),e.jsxs("td",{className:"py-4 px-4 text-sm text-gray-500 dark:text-gray-300",children:["Sản phẩm #",s.id]}),e.jsxs("td",{className:"py-4 px-4 text-sm text-gray-500 dark:text-gray-300",children:[((i=(c=s.import_price)==null?void 0:c.toLocaleString)==null?void 0:i.call(c))||0,"đ"]}),e.jsx("td",{className:"py-4 px-4 text-sm",children:e.jsx("span",{className:`px-2.5 py-1 text-xs font-semibold rounded-full ${o.className}`,children:o.text})}),e.jsx("td",{className:"py-4 px-4 text-center",children:e.jsx("div",{className:"flex justify-center items-center",children:e.jsx(C,{to:`/admin/pendingProducts/${s.id}`,title:"Xem chi tiết",children:e.jsx(E,{className:"text-green-500 hover:text-green-400 dark:text-green-400 dark:hover:text-green-300 cursor-pointer transition-colors",size:22})})})})]},s.id)})})]})})}const _=["sku"],O=()=>{const{pop:h,conFim:m}=R(),[s,o]=n.useState([]),[c,i]=n.useState(!0),[j,p]=n.useState(null),[x,k]=n.useState(""),g=B(),l=F(),b=n.useMemo(()=>{const t=new URLSearchParams(l.search),a={};return w.forEach(r=>{r.type==="number_range"?(t.has(r.minName)&&(a[r.minName]=t.get(r.minName)),t.has(r.maxName)&&(a[r.maxName]=t.get(r.maxName))):t.has(r.name)&&(a[r.name]=t.get(r.name))}),a},[l.search]),u=n.useCallback(async()=>{i(!0);const t=new URLSearchParams(l.search);try{const a=await N.get("/admin/products/browse",{params:t}),{data:r,...d}=a.data.data;o(r),p(d)}catch(a){h("lấy dữ liệu thất bại","e"),console.error("Lỗi khi tải dữ liệu:",a),o([]),p(null)}finally{i(!1)}},[l.search]);n.useEffect(()=>{u()},[u]);const L=t=>{const a=new URLSearchParams;for(const r in t)a.set(r,t[r]);a.set("page","1"),g({search:a.toString()})},S=()=>{g({search:""})},P=t=>{const a=new URLSearchParams(l.search);a.set("page",t),g({search:a.toString()}),k("")},v=n.useMemo(()=>{if(!x)return s;const t=x.toLowerCase();return s.filter(a=>_.some(r=>{var d;return(d=a[r])==null?void 0:d.toString().toLowerCase().includes(t)}))},[s,x]),f=async(t,a,r)=>{if(await m(r))try{const y=`/admin/products/${a}/${t}`;await N.post(y),u()}catch(y){console.error(`Lỗi khi thực hiện hành động ${t}:`,y)}};return c?e.jsx(T,{}):e.jsx(A,{title:"Danh sách tài khoản game chờ duyệt",showBackButton:!1,showBrowse:!1,showAddButton:!0,onLocalSearch:k,initialSearchTermLocal:x,paginationMeta:j,onPageChange:P,onApplyFilters:L,onResetFilters:S,initialFilters:b,filterConfig:w,activeFilterCount:Object.keys(b).length,children:e.jsx(U,{products:v,handleKey:t=>f("restore",t,"Kích hoạt lại sản phẩm này?"),handleLock:t=>f("cancel",t,"Khóa sản phẩm này?")})})};export{O as default};
