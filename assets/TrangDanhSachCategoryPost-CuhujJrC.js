import{r as a,u as C,b as _,k as L,f as N,j as e,L as y,S as T,l as D,g as F}from"./index-OefKdV4-.js";import{u as z}from"./index-CW-6dsA4.js";import{D as E}from"./react-datepicker-CnkPl9PV.js";import{P as X}from"./Pagination-B0ANGdal.js";import{P as R}from"./plus-B6PeJhiB.js";import{T as $}from"./trash-2-CKvMulze.js";import{F as B}from"./file-text-vZjSIQxt.js";import"./chevron-left-DzZmHbAx.js";import"./chevron-right-C6ZOff9V.js";const M=n=>new Date(n).toLocaleDateString("vi-VN");function J(){const[n,v]=a.useState([]),[m,w]=a.useState(null),[x,g]=a.useState(!0),{pop:c,conFim:k}=C(),i=_(),l=L(),d=a.useMemo(()=>new URLSearchParams(l.search),[l.search]),[r,p]=a.useState({search:d.get("search")||"",start_date:d.get("start_date")||"",end_date:d.get("end_date")||""}),o=z(r,500),h=a.useCallback(async()=>{g(!0);try{const t=await N.get(`/admin/categoryPost${l.search}`);v(t.data.data.data),w(t.data.data)}catch{c("Lỗi khi tải danh mục bài viết","e")}finally{g(!1)}},[l.search,c]);a.useEffect(()=>{const t=new URLSearchParams;Object.keys(o).forEach(s=>{o[s]&&t.set(s,o[s])}),i({search:t.toString()},{replace:!0})},[o,i]),a.useEffect(()=>{h()},[h]);const P=async t=>{if(await k("Bạn có chắc chắn muốn xóa danh mục này?"))try{await N.delete(`/admin/categoryPost/${t}`),c("Xóa danh mục thành công","s"),h()}catch{c("Xóa danh mục thất bại.","e")}},u=(t,s)=>{const b={...r,[t]:s},j=new URLSearchParams(l.search);j.set("page","1"),p(b),i({search:j.toString()})},S=()=>p({search:"",start_date:"",end_date:""}),f=Object.values(r).filter(Boolean).length;return e.jsxs("div",{className:"p-4 sm:p-6 bg-slate-50 dark:bg-slate-900 min-h-screen font-sans",children:[e.jsxs("header",{className:"flex flex-col sm:flex-row justify-between sm:items-center mb-6 gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-800 dark:text-slate-100",children:"Danh mục Bài viết"})," ",e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:"Tạo và quản lý các danh mục cho bài viết."})]}),e.jsx(y,{to:"/admin/categoryPost/new",children:e.jsxs("button",{className:"flex items-center justify-center gap-2 w-full sm:w-auto bg-indigo-600 text-white px-4 py-2.5 rounded-lg shadow-md hover:bg-indigo-700 transition-colors",children:[e.jsx(R,{size:18})," Thêm danh mục"]})})]}),e.jsx("div",{className:"my-6 p-4 bg-white dark:bg-slate-800 rounded-lg shadow-sm",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative lg:col-span-2",children:[e.jsx(T,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18}),e.jsx("input",{type:"text",placeholder:"Tìm theo tên, mô tả...",value:r.search,onChange:t=>u("search",t.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-700 text-sm focus:ring-2 focus:ring-indigo-500"})]}),e.jsx(E,{selected:r.start_date?new Date(r.start_date):null,onChange:t=>u("start_date",(t==null?void 0:t.toISOString().split("T")[0])||""),placeholderText:"Từ ngày",isClearable:!0,className:"w-full px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-700 text-sm focus:ring-2 focus:ring-indigo-500"}),e.jsxs("button",{onClick:S,className:"relative flex items-center justify-center gap-2 bg-slate-200 dark:bg-slate-700 text-slate-700 dark:text-slate-200 px-4 py-2 rounded-lg hover:bg-slate-300 dark:hover:bg-slate-600 transition-colors",children:[e.jsx(D,{size:16})," Xóa bộ lọc",f>0&&e.jsx("span",{className:"absolute -top-2 -right-2 flex h-5 w-5 items-center justify-center rounded-full bg-red-500 text-xs font-bold text-white",children:f})]})]})}),e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left text-slate-500 dark:text-slate-400",children:[e.jsx("thead",{className:"text-xs text-slate-700 dark:text-slate-300 uppercase bg-slate-50 dark:bg-slate-700/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3",children:"Tên danh mục"}),e.jsx("th",{className:"px-6 py-3",children:"Mô tả"}),e.jsx("th",{className:"px-6 py-3",children:"Ngày tạo"}),e.jsx("th",{className:"px-6 py-3 text-center",children:"Hành động"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:x?Array.from({length:8}).map((t,s)=>e.jsx("tr",{className:"animate-pulse",children:e.jsx("td",{colSpan:"4",className:"p-4",children:e.jsx("div",{className:"h-6 bg-slate-200 dark:bg-slate-700 rounded w-full"})})},s)):n.length>0?n.map(t=>e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-700/50",children:[e.jsx("td",{className:"px-6 py-4 font-medium text-slate-800 dark:text-slate-100",children:t.name}),e.jsx("td",{className:"px-6 py-4",children:t.description}),e.jsx("td",{className:"px-6 py-4",children:M(t.created_at)}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex justify-center items-center space-x-2",children:[e.jsx(y,{to:`/admin/categoryPost/${t.slug}/edit`,title:"Chỉnh sửa",className:"p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-500 hover:text-indigo-600",children:e.jsx(F,{size:16})}),e.jsx("button",{onClick:()=>P(t.slug),title:"Xóa",className:"p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-500 hover:text-red-600",children:e.jsx($,{size:16})})]})})]},t.id)):e.jsx("tr",{children:e.jsxs("td",{colSpan:"4",className:"text-center py-16 text-slate-500",children:[e.jsx(B,{size:48,className:"mx-auto mb-2"}),"Không có danh mục nào."]})})})]})}),!x&&m&&e.jsx(X,{meta:m,onPageChange:t=>i({search:`?page=${t}`})})]})}export{J as default};
