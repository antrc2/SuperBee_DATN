import{c as x,r as l,j as e,h as C,a5 as M,aA as y,E as $,X as E,e as L,aB as A}from"./index-Ck68-v7X.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=[["path",{d:"M17 7 7 17",key:"15tmo1"}],["path",{d:"M17 17H7V7",key:"1org7z"}]],K=x("arrow-down-left",F);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],z=x("arrow-up-right",R);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],H=x("loader",V),N=t=>{if(!t)return"N/A";const n=new Date(t),r=String(n.getDate()).padStart(2,"0"),d=String(n.getMonth()+1).padStart(2,"0"),s=n.getFullYear();return`${r}/${d}/${s}`},h=t=>(t==null&&(t=0),new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(t)),f=t=>{switch(t){case"recharge_bank":return"N·∫°p ti·ªÅn (Ng√¢n h√†ng)";case"recharge_card":return"N·∫°p ti·ªÅn (Th·∫ª c√†o)";case"purchase":return"Thanh to√°n ƒë∆°n h√†ng";case"withdraw":return"R√∫t ti·ªÅn";default:return"Kh√¥ng x√°c ƒë·ªãnh"}},I=({transaction:t,onClose:n})=>{if(!t)return null;const r=t.type.includes("recharge"),d=()=>t.type==="purchase"&&t.order?e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-semibold text-primary",children:"Chi ti·∫øt ƒë∆°n h√†ng"}),e.jsxs("div",{className:"bg-background/50 p-4 rounded-lg border border-themed space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-secondary",children:"M√£ ƒë∆°n h√†ng:"}),e.jsxs("span",{className:"text-primary font-mono",children:["#",t.order.order_code]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-secondary",children:"T·ªïng ti·ªÅn:"}),e.jsx("span",{className:"text-primary font-medium",children:h(t.order.total_amount)})]})]})]}):e.jsx("p",{className:"text-secondary text-sm",children:"Kh√¥ng c√≥ th√¥ng tin chi ti·∫øt cho lo·∫°i giao d·ªãch n√†y."});return e.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 flex justify-center items-center p-4 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-dropdown border border-themed rounded-2xl shadow-2xl w-full max-w-md flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center p-5 border-b border-themed",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-accent/10 rounded-lg",children:e.jsx(y,{className:"h-6 w-6 text-accent"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-heading text-xl font-bold text-primary",children:"Chi ti·∫øt giao d·ªãch"}),e.jsxs("p",{className:"text-secondary text-sm font-mono",children:["#",t.id]})]})]}),e.jsx("button",{onClick:n,className:"p-2 rounded-full text-secondary hover:text-primary hover:bg-accent/10 transition-colors",children:e.jsx(E,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-secondary",children:"Ng√†y:"}),e.jsx("p",{className:"font-semibold text-primary",children:N(t.created_at)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-secondary",children:"Lo·∫°i:"}),e.jsx("p",{className:"font-semibold text-primary",children:f(t.type)})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-secondary",children:"S·ªë ti·ªÅn:"}),e.jsxs("p",{className:`text-2xl font-bold ${r?"text-status-success-text":"text-red-500"}`,children:[r?"+ ":"- ",h(t.amount)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-secondary",children:"Tr·∫°ng th√°i:"}),e.jsx("div",{className:"mt-1",children:v(t.status)})]}),e.jsx("hr",{className:"border-themed !my-6"}),d()]}),e.jsx("div",{className:"p-4 border-t border-themed bg-background/50 text-right",children:e.jsx("button",{onClick:n,className:"action-button action-button-secondary !w-auto",children:"ƒê√≥ng"})})]})})},B=t=>{switch(t){case"recharge_bank":case"recharge_card":return e.jsx(K,{className:"h-5 w-5 text-status-success-text"});case"purchase":return e.jsx(A,{className:"h-5 w-5 text-accent"});case"withdraw":return e.jsx(z,{className:"h-5 w-5 text-status-cancelled-text"});default:return e.jsx(L,{className:"h-5 w-5 text-secondary"})}},v=t=>{const r={1:{text:"Th√†nh c√¥ng",className:"bg-status-success-bg text-status-success-text"},0:{text:"ƒêang x·ª≠ l√Ω",className:"bg-status-processing-bg text-status-processing-text"}}[t]||{text:"Kh√¥ng x√°c ƒë·ªãnh",className:"bg-gray-500/20 text-gray-400"};return e.jsx("span",{className:`px-3 py-1 text-xs font-bold rounded-full ${r.className}`,children:r.text})};function X(){const[t,n]=l.useState([]);console.log("üöÄ ~ TransactionHistoryPage ~ allTransactions:",t);const[r,d]=l.useState([]),[s,w]=l.useState({type:"all",status:"all",startDate:"",endDate:""}),[m,u]=l.useState(null),[k,p]=l.useState(!0),[g,j]=l.useState(null);l.useEffect(()=>{(async()=>{var c,b;p(!0),j(null);try{const i=await C.get("/user/history-trans"),T=((b=(c=i==null?void 0:i.data)==null?void 0:c.wallet)==null?void 0:b.transactions)||[];n(T.sort((_,S)=>new Date(S.created_at)-new Date(_.created_at)))}catch(i){j("Kh√¥ng th·ªÉ t·∫£i l·ªãch s·ª≠ giao d·ªãch. Vui l√≤ng th·ª≠ l·∫°i sau."),console.error(i)}finally{p(!1)}})()},[]),l.useEffect(()=>{let a=t.filter(c=>(s.type==="all"||c.type===s.type)&&(s.status==="all"||c.status.toString()===s.status)&&(!s.startDate||new Date(c.created_at)>=new Date(s.startDate))&&(!s.endDate||new Date(c.created_at)<new Date(new Date(s.endDate).setDate(new Date(s.endDate).getDate()+1))));d(a)},[s,t]);const o=a=>{w(c=>({...c,[a.target.name]:a.target.value}))},D=()=>k?e.jsxs("div",{className:"flex flex-col items-center justify-center text-center p-10",children:[e.jsx(H,{className:"w-12 h-12 animate-spin text-accent mb-4"}),e.jsx("p",{className:"text-secondary",children:"ƒêang t·∫£i d·ªØ li·ªáu..."})]}):g?e.jsxs("div",{className:"alert alert-danger",children:[e.jsx(M,{className:"w-5 h-5 inline-block mr-2"}),g]}):r.length===0?e.jsxs("div",{className:"text-center p-10 bg-background rounded-lg border border-themed",children:[e.jsx(y,{className:"w-12 h-12 mx-auto text-secondary/50 mb-4"}),e.jsx("p",{className:"text-secondary",children:"Kh√¥ng c√≥ giao d·ªãch n√†o ph√π h·ª£p."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.map(a=>e.jsxs("div",{className:"bg-background p-4 rounded-xl border border-themed transition-all duration-300 hover:border-accent hover:shadow-lg hover:-translate-y-1",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-lg section-bg",children:B(a.type)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-primary",children:f(a.type)}),e.jsx("p",{className:"text-sm text-secondary",children:N(a.created_at)})]})]}),v(a.status)]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-themed flex justify-between items-end",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-secondary",children:"S·ªë ti·ªÅn"}),e.jsxs("p",{className:`text-xl font-bold ${a.type.includes("recharge")?"text-status-success-text":"text-red-500"}`,children:[a.type.includes("recharge")?"+ ":"- ",h(a.amount)]})]}),e.jsxs("button",{onClick:()=>u(a),className:"flex items-center gap-1.5 text-sm font-semibold text-accent hover:text-accent/80 transition-colors",children:[e.jsx($,{className:"h-4 w-4"}),"Xem"]})]})]},a.id))});return e.jsxs("section",{className:"section-bg p-6 md:p-8 rounded-2xl shadow-lg space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"font-heading text-2xl md:text-3xl font-bold text-primary",children:"L·ªãch s·ª≠ giao d·ªãch"}),e.jsx("p",{className:"text-secondary mt-1",children:"Theo d√µi c√°c kho·∫£n thu chi trong v√≠ c·ªßa b·∫°n."})]}),e.jsx("div",{className:"bg-background p-4 rounded-xl border border-themed",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 items-end",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-secondary mb-2",children:"Lo·∫°i giao d·ªãch"}),e.jsxs("select",{name:"type",value:s.type,onChange:o,className:"w-full rounded-lg px-3 py-2 bg-input text-input border-themed border-hover",children:[e.jsx("option",{value:"all",children:"T·∫•t c·∫£"}),e.jsx("option",{value:"recharge_bank",children:"N·∫°p ti·ªÅn (Ng√¢n h√†ng)"}),e.jsx("option",{value:"recharge_card",children:"N·∫°p ti·ªÅn (Th·∫ª c√†o)"}),e.jsx("option",{value:"purchase",children:"Thanh to√°n"}),e.jsx("option",{value:"withdraw",children:"R√∫t ti·ªÅn"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-secondary mb-2",children:"Tr·∫°ng th√°i"}),e.jsxs("select",{name:"status",value:s.status,onChange:o,className:"w-full rounded-lg px-3 py-2 bg-input text-input border-themed border-hover",children:[e.jsx("option",{value:"all",children:"T·∫•t c·∫£"}),e.jsx("option",{value:"1",children:"Th√†nh c√¥ng"}),e.jsx("option",{value:"0",children:"ƒêang x·ª≠ l√Ω"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-secondary mb-2",children:"T·ª´ ng√†y"}),e.jsx("input",{type:"date",name:"startDate",value:s.startDate,onChange:o,className:"w-full rounded-lg px-3 py-2 bg-input text-input border-themed border-hover"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-secondary mb-2",children:"ƒê·∫øn ng√†y"}),e.jsx("input",{type:"date",name:"endDate",value:s.endDate,onChange:o,className:"w-full rounded-lg px-3 py-2 bg-input text-input border-themed border-hover"})]})]})}),e.jsx("div",{className:"min-h-[20rem]",children:D()}),m&&e.jsx(I,{transaction:m,onClose:()=>u(null)})]})}export{X as default};
