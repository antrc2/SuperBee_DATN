import{k as G,d as I,r as n,j as e,l as L,E as $,X as B,h as j}from"./index-C-Tm1Ach.js";import{A as H}from"./arrow-left-BXpuDJ1B.js";import{E as K}from"./eye-off-DpBzcALm.js";function R(){const{id:u}=G(),x=I(),[S,v]=n.useState(null),[o,g]=n.useState(!1),[T,N]=n.useState(!0),[y,c]=n.useState(null),[p,E]=n.useState(!1),[F,m]=n.useState(!1),[d,_]=n.useState({price:"",sale:"",newPassword:""}),[h,k]=n.useState({}),[l,D]=n.useState({sku:"",category_id:"",category_name:"",import_price:"",username:"",password:"",attributes:[{attribute_key:"",attribute_value:""}],images:[]});console.log("🚀 ~ UpdateProductBrowse ~ formData:",l),n.useEffect(()=>{(async()=>{var a,t,s,b,C;N(!0);try{const f=(await j.get(`/admin/products/${u}`)).data.data;if(Array.isArray(f)&&f.length>0){const i=f[0];v(i),D({sku:i.sku||"",category_id:i.category_id||"",category_name:((a=i.category)==null?void 0:a.name)||"",import_price:i.import_price||"",username:((s=(t=i.credentials)==null?void 0:t[0])==null?void 0:s.username)||"",password:((C=(b=i.credentials)==null?void 0:b[0])==null?void 0:C.password)||"",attributes:i.game_attributes||[{attribute_key:"",attribute_value:""}],images:i.images||[]})}else v(null),c("Sản phẩm không tồn tại.")}catch(P){console.error(P),c("Không tìm thấy sản phẩm hoặc có lỗi xảy ra.")}finally{N(!1)}})()},[u]);const w=r=>{const{name:a,value:t}=r.target;_(s=>({...s,[a]:t}))},M=()=>{const r={};return d.price?Number(d.price)<=Number(l.import_price)&&(r.price="Giá bán phải lớn hơn giá gốc."):r.price="Vui lòng nhập giá bán.",d.sale&&Number(d.sale)>=Number(d.price)&&(r.sale="Giá sale phải nhỏ hơn giá bán."),r},O=()=>{_({price:"",sale:"",newPassword:""}),k({}),m(!0)},z=async()=>{var a,t;g(!0),c(null),k({});const r=M();if(Object.keys(r).length>0){k(r),g(!1);return}try{const s=new FormData;s.append("price",d.price),s.append("sale",d.sale),s.append("status","1"),s.append("password",d.newPassword||l.password);const b=await j.post(`/admin/products/${u}/accept`,s,{headers:{"Content-Type":"multipart/form-data"}});(b.status===201||b.status===200)&&(m(!1),x("/admin/products"))}catch(s){c(((t=(a=s.response)==null?void 0:a.data)==null?void 0:t.message)||"Cập nhật sản phẩm thất bại, vui lòng thử lại.")}finally{g(!1)}},A=async()=>{var r,a;g(!0),c(null);try{const t=await j.post(`/admin/products/${u}/deny`);(t.status===201||t.status===200)&&x("/admin/products")}catch(t){c(((a=(r=t.response)==null?void 0:r.data)==null?void 0:a.message)||"Từ chối sản phẩm thất bại, vui lòng thử lại.")}finally{g(!1)}};return T?e.jsx("div",{className:"flex justify-center items-center h-screen bg-white dark:bg-gray-900",children:e.jsx(L,{className:"animate-spin text-blue-500",size:48})}):e.jsxs("div",{className:"bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-200 min-h-screen p-4 sm:p-6 lg:p-8",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs("button",{type:"button",onClick:()=>x(-1),className:"flex items-center gap-2 text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white px-4 py-2 rounded-lg transition-colors border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 shadow-sm dark:shadow-md",children:[e.jsx(H,{size:20}),e.jsx("span",{className:"font-medium",children:"Quay lại"})]}),e.jsxs("h1",{className:"text-2xl font-semibold text-gray-800 dark:text-white",children:["Thông tin chi tiết:"," ",e.jsxs("span",{className:"text-blue-500 dark:text-blue-400 font-mono",children:["#",l.sku]})]})]}),y&&e.jsx("div",{className:"bg-red-100 dark:bg-red-500/20 border border-red-300 dark:border-red-500/30 text-red-700 dark:text-red-400 p-4 rounded-lg mb-6",children:y}),S?e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"p-6 border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 rounded-lg shadow-md dark:shadow-lg",children:[e.jsx("h3",{className:"mb-4 font-semibold text-lg text-gray-800 dark:text-white",children:"Thông tin cơ bản"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category_name",className:"block mb-2 text-sm font-medium text-gray-700 dark:text-gray-400",children:"Danh mục"}),e.jsx("input",{name:"category_name",id:"category_name",value:l.category_name,readOnly:!0,className:"w-full p-2.5 rounded-md border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-300 cursor-not-allowed"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"import_price",className:"block mb-2 text-sm font-medium text-gray-700 dark:text-gray-400",children:"Giá gốc"}),e.jsx("input",{name:"import_price",type:"number",value:l.import_price,readOnly:!0,className:"w-full p-2.5 rounded-md border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-300 cursor-not-allowed"})]})]})]}),e.jsxs("div",{className:"p-6 border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 rounded-lg shadow-md dark:shadow-lg",children:[e.jsx("h3",{className:"text-lg font-semibold leading-6 text-gray-800 dark:text-white mb-4",children:"Thông tin đăng nhập"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 dark:text-gray-400 mb-2",children:"Tài khoản đăng nhập"}),e.jsx("input",{type:"text",name:"username",id:"username",value:l.username,readOnly:!0,className:"w-full rounded-md border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-300 p-2.5 cursor-not-allowed"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-400 mb-2",children:"Mật khẩu hiện tại"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:p?"text":"password",name:"password",id:"password",value:l.password,readOnly:!0,className:"w-full rounded-md border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-300 p-2.5 cursor-not-allowed"}),e.jsx("button",{type:"button",onClick:()=>E(!p),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-white transition-colors",children:p?e.jsx(K,{size:18}):e.jsx($,{size:18})})]})]})]})]}),e.jsxs("div",{className:"p-6 border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 rounded-lg shadow-md dark:shadow-lg",children:[e.jsx("h3",{className:"text-lg font-semibold leading-6 text-gray-800 dark:text-white mb-4",children:"Thuộc tính sản phẩm"}),e.jsx("div",{className:"space-y-4",children:l.attributes.map((r,a)=>e.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[e.jsx("input",{type:"text",placeholder:"Tên thuộc tính",value:r.attribute_key,readOnly:!0,className:"w-full rounded-md border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-300 p-2.5 cursor-not-allowed"}),e.jsx("input",{type:"text",placeholder:"Giá trị",value:r.attribute_value,readOnly:!0,className:"w-full rounded-md border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-300 p-2.5 cursor-not-allowed"})]},a))})]}),e.jsxs("div",{className:"p-6 border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 rounded-lg shadow-md dark:shadow-lg",children:[e.jsx("h3",{className:"text-lg font-semibold leading-6 text-gray-800 dark:text-white mb-2",children:"Hình ảnh minh họa"}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:["Đã chọn: ",l.images.length," / 5 ảnh."]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4",children:l.images.map((r,a)=>e.jsx("div",{className:"relative aspect-square border-2 border-gray-300 dark:border-gray-700 rounded-md overflow-hidden bg-gray-100 dark:bg-gray-900",children:e.jsx("img",{src:`${r.image_url}`,alt:r.alt_text||"Ảnh sản phẩm",className:"w-full h-full object-cover"})},r.id||a))})]}),e.jsxs("div",{className:"pt-6 flex flex-col sm:flex-row gap-4 justify-end",children:[e.jsx("button",{type:"button",onClick:A,disabled:o,className:"w-full sm:w-auto bg-red-500 dark:bg-red-600 text-white font-semibold py-2.5 px-6 rounded-lg hover:bg-red-400 dark:hover:bg-red-700 disabled:bg-red-300 dark:disabled:bg-red-800 disabled:cursor-not-allowed transition-colors",children:o?"Đang xử lý...":"Từ chối sản phẩm"}),e.jsx("button",{type:"button",onClick:O,disabled:o,className:"w-full sm:w-auto bg-blue-500 dark:bg-blue-600 text-white font-semibold py-2.5 px-6 rounded-lg hover:bg-blue-400 dark:hover:bg-blue-700 disabled:bg-blue-300 dark:disabled:bg-blue-800 disabled:cursor-not-allowed transition-colors",children:o?"Đang xử lý...":"Chấp nhận sản phẩm"})]})]}):e.jsx("p",{className:"text-center text-gray-500 dark:text-gray-400 py-10",children:y||"Không có dữ liệu để hiển thị."})]}),F&&e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:[e.jsx("div",{className:"absolute inset-0 bg-black/30 dark:bg-black/60 backdrop-blur-sm",onClick:()=>!o&&m(!1)}),e.jsxs("div",{className:"relative bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl shadow-lg dark:shadow-2xl p-6 sm:p-8 w-full max-w-md mx-4 z-50",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-white",children:"Cấu hình sản phẩm"}),e.jsx("button",{onClick:()=>!o&&m(!1),className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-white transition-colors",children:e.jsx(B,{size:24})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:["Giá bán ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",name:"price",value:d.price,onChange:w,className:"w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-white placeholder:text-gray-500 dark:placeholder:text-gray-500 p-2.5 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/30 transition-shadow",placeholder:"Nhập giá bán"}),h.price&&e.jsx("div",{className:"text-red-500 dark:text-red-400 text-xs mt-1.5",children:h.price})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Giá sale (Tùy chọn)"}),e.jsx("input",{type:"number",name:"sale",value:d.sale,onChange:w,className:"w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-white placeholder:text-gray-500 dark:placeholder:text-gray-500 p-2.5 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/30 transition-shadow",placeholder:"Nhập giá sale"}),h.sale&&e.jsx("div",{className:"text-red-500 dark:text-red-400 text-xs mt-1.5",children:h.sale})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Mật khẩu mới (Tùy chọn)"}),e.jsx("input",{type:"password",name:"newPassword",value:d.newPassword,onChange:w,className:"w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-white placeholder:text-gray-500 dark:placeholder:text-gray-500 p-2.5 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/30 transition-shadow",placeholder:"Để trống nếu không muốn đổi"})]})]}),e.jsxs("div",{className:"flex flex-col-reverse sm:flex-row gap-3 justify-end mt-8",children:[e.jsx("button",{type:"button",onClick:()=>!o&&m(!1),disabled:o,className:"w-full sm:w-auto px-4 py-2 text-gray-700 dark:text-white bg-gray-200 dark:bg-gray-600 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors disabled:opacity-50",children:"Hủy"}),e.jsx("button",{type:"button",onClick:z,disabled:o,className:"w-full sm:w-auto px-4 py-2 bg-blue-500 dark:bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-400 dark:hover:bg-blue-700 disabled:bg-blue-300 dark:disabled:bg-blue-800 disabled:cursor-wait transition-colors",children:o?"Đang xử lý...":"Chấp nhận"})]})]})]})]})}export{R as default};
